<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>SVG Scripting - webGL - LDATA City</title>
    <meta name="description" content="Ldata è speciale quanto le persone che la compongono: un team di designer, sviluppatori e creativi guidati dal desiderio di costruire esperienze utente non standard e significative.

    " />

    <link rel="icon" type="image/png" href="img/ldata-logo-icon.svg" />
        <!--Core CSS -->
    <style>
      body::after{
   position:absolute; width:0; height:0; overflow:hidden; z-index:-1;
   content: url(' img/widget/js.jpg') url(' img/widget/wp.png') url(' img/graphics/widgets/mini-widget-1-night.png') url(' img/widget/pw.png') url(' img/graphics/icons/robotics-1-core.svg') url(' img/graphics/icons/robotics-2-core.svg')  url(' img/graphics/icons/robotics-3-core.svg')  url(' img/graphics/icons/robotics-4-core.svg') url(' img/widget/html5.png'); 
}
    </style>
        <link rel="stylesheet" href="css/app.css">
       <link rel="stylesheet" href="css/core.css">
        
	

       
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>     

    <script src="jsminified/gsap.min.js"></script>
    <script src="jsminified/DrawSVGPlugin.min.js"></script>
    <script src="jsminified/MotionPathPlugin.min.js"></script>
    <script src="jsminified/ScrambleTextPlugin.min.js"></script>
    <script src="jsminified/EaselPlugin.min.js"></script>
    <script src="jsminified/InertiaPlugin.min.js"></script>  
    <script src="jsminified/MorphSVGPlugin.min.js"></script>
    <script src="jsminified/SplitText.min.js"></script>
    <script src="jsminified/ScrollTrigger.min.js"></script>
    <script src="jsminified/ScrollToPlugin.min.js"></script>
    <script src="jsminified/Physics2DPlugin.min.js"></script>
    <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    
    
    <script>

    gsap.config({ nullTargetWarn: false });
    //list 
    gsap.registerPlugin(ScrollToPlugin, DrawSVGPlugin, MotionPathPlugin, ScrambleTextPlugin, EaselPlugin, InertiaPlugin, MorphSVGPlugin, SplitText, Physics2DPlugin, ScrollTrigger );

document.addEventListener("DOMContentLoaded", function(event){



//Random vars
let rnum_var = gsap.utils.random([ "crimson", "powderblue", "cadetblue", "slategrey", "firebrick", "yellowgreen", "darkorange", "dodgerblue", "lightgoldenrodyellow", "burlywood", "khaki", "goldenrod", "lightsalmon", "cyan", "tomato"], true); 
let rnum_var2 = gsap.utils.random([ "yellowgreen", "darkorange", "dodgerblue", "lightgoldenrodyellow", "goldenrod", "lightsalmon"], true); 
let rnum_var3 = gsap.utils.random([ "#6c87e7cc", "#adadf6d9", "#8c8cf9eb", "6d6dffd6", "#6b6bb6cc", "#555fcaa3", "#9e1ef782", "#88a1f7d9", "#9999eed1", "#6d6dd1e8", "#762ff9cc", "#f5f5f5f0", "#9595ebd6"], true); 

let rnum_eases = gsap.utils.random(["power1.inOut", "power2.Out", "sine.inOut"], false);
let rnum_eases2 = gsap.utils.random(["power1.inOut", "power2.Out", "sine.inOut"], false);
let rnum_eases3 = gsap.utils.random(["power1.inOut", "power2.Out", "sine.inOut"], false);

let mycolor = gsap.utils.random(["#aab9c2", "#fff", "#8080e9"], true);

let msg_ran = gsap.utils.random(["Data Collection 🐳🎍🌰🍆", "Cms open source 🌱🐝", "Progressive Web Apps 🐠", "Design e implementazione 🐬", "Static Web Apps 🐢", "Content Management Sys 🌵", "Dynamic Web Apps 🐍", "Portal Web Apps 🐘", "Cross-browser compatibility🐛", "Data Collection 🌽", "Intelligent Apps 🐸", "Insights-driven apps 🥝", "Performance Obsess 🌶️", "Sviluppo CMS 🐞", "Web Hosting Pro 🐊", "Siti Web Dinamici 🍑", "Modern Web Standard 🐟", "Web Forms 🕸️", "Modern Web Animation 🍓", "Data Visualization 🍇", "JS Developers 🍋", "Full Stack Developers █̆̈◤࿉∥",  "Web App Development 🍏",  "UX/UI Design)━☆ﾟ.*･｡ﾟ",  "Web App Programming (ღ ･ิ◡･ิ)ε",  "We work remotely (((༼•̫͡•༽)))",  "Software as a service 🥑",  "Soluzioni SaaS  🍊",  "Full Stack Developers 🍏", "Front-end Developers 🐙"  ], true); 

let msg_ran2 = gsap.utils.random(["Welcome to Livedata 😀", "Benvenuti su Livedata 😀🐬🐍🐊🦆🐠🐟🐙🐸🦈🐡🐋🦖🦕🐲🐯🐎🐅🐇🐛🐜🐝🐌🦋🕸️🐞🦗🕷️🦁🐿️🐘" ], true); 

let msg_boat = gsap.utils.random(["Welcome to Livedata 😀", "Welcome to Livedata 🐳🎍🌰", "Welcome to Livedata 3 🎍🎍🎍"]);

let music_ran = gsap.utils.random(["japan-lover", "broken-hip-mix1", "electro-moonlight", "last-youth", "aphex"]);


   //City Start Fun
   function cityStart () {
       
   let tl = gsap.timeline({
  
    repeatRefresh: false, // invalidates on each repeat
    yoyo: false, // if true > A-B-B-A, if false > A-B-A-B
    defaults: { // children inherit these defaults
    duration: 2.1,
    ease: "none" 
  },
  smoothChildTiming: true,
  autoRemoveChildren: true
 });
             
        tl.set("#svg_container", {opacity: 1, stagger: 0.1});
        tl.set(".svg-elem-12", {opacity:0});

        tl.set(".st1", {autoAlpha:0});
        tl.set(".st5", {autoAlpha:0});
        tl.set(".st6", {autoAlpha:0});
        tl.set(".st7", {autoAlpha:0});
        tl.set(".st8", {autoAlpha:0});
        tl.set(".svg-elem-1", {autoAlpha:0});
        tl.set(".svg-elem-10", {autoAlpha:0});
        tl.set(".svg-elem-11", {autoAlpha:0});
        tl.set(".svg-elem-17", {autoAlpha:0})
        tl.set(".svg-elem-18", {autoAlpha:0})

     
        tl.from(".st1", {delay:0.4, autoAlpha:1, duration: 0.7, drawSVG: 1})

        .to(".svg-elem-17", {autoAlpha:1, duration: 0, opacity: 1 })
        .to(".svg-elem-18", {autoAlpha:1, duration: 0, opacity: 1})
        
        .from(".st5", {autoAlpha:1, duration: 0, drawSVG: 2})
        .from(".st6", {autoAlpha:1, duration: 0.6, drawSVG: 3})
        .from(".st7", {autoAlpha:1, duration: 0.1, drawSVG: 4})
        .from(".st8", {autoAlpha:1, duration: 0.1, drawSVG: 5})

        .from(".svg-elem-1", {duration: 0.2, autoAlpha:1, drawSVG: 6})
        .from(".svg-elem-10", {duration: 0.2, autoAlpha:1, drawSVG: 7})
        .from(".svg-elem-11", {stagger: 0.2, autoAlpha:1, duration: 0.2, drawSVG: 8})

        .add(flag_box()).to("#flag1", {stagger: 0.1, duration: 0.3, opacity: 1})       
        .to(".svg-elem-12", {duration: 0.6, opacity: 0.8})
        

        .to("#msg_text", {duration: 0.5, opacity: 1})
        .to("#msg_text3", {duration: 0.5, opacity: 1});
       // .to(".wrapper_menu", {duration: 0.1, opacity:1})
  
    boat1();
    boat2();
    boat3();     



    } //end cityStart()


    //COLORIZE EFFECTS
     
    //Register Color 1 Effect    
    gsap.registerEffect({
    name: "colorize1",
    defaults: {duration: 2}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, {duration: config.duration, yoyoEase: true, repeatRefresh: true, fill: "#8c8cf9eb"});
    }
 });

    //Register Color 2 Effect    
    gsap.registerEffect({
    name: "colorize2",
    defaults: {duration: 2}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, {duration: config.duration, fill: rnum_var3});
    }
 });

   //Register Color 3 Effect    
    gsap.registerEffect({
    name: "colorize3",
    defaults: {duration: 2}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, {duration: config.duration, fill: rnum_var3});
    }
 })

    //Register Color 4 Effect    
    gsap.registerEffect({
    name: "colorize4",
    defaults: {duration: 2}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, {duration: config.duration, fill: rnum_var3});
    }
 })

     //Register Color 5 Effect - Random   
     gsap.registerEffect({
    name: "colorize5",
    defaults: {duration: 0.1}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, { duration: config.duration, fill: rnum_var3});
    }
 })

      //Register Color 6 Effect - Reset (White)   
      gsap.registerEffect({
    name: "colorize6",
    defaults: {duration: 0.9}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, { duration: config.duration, fill: "#fff"});
    }
 })

       //Register Color 7 Effect - Reset (White)   
       gsap.registerEffect({
    name: "colorize7",
    defaults: {duration: 0.9}, //defaults get applied to the "config" object passed to the effect below
    effect: (targets, config) => {
        return gsap.to(targets, { duration: config.duration, fill: "rgba(237, 237, 237, 0.99)"});
    }
 })


//gsap.effects.fade(".box");

// Paint color Target 1
document.querySelectorAll(".st1").forEach(function(paint1) {
    paint1.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 2
document.querySelectorAll(".st6").forEach(function(paint2) {
    paint2.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 3
document.querySelectorAll(".svg-elem-1").forEach(function(paint3) {
    paint3.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 4
document.querySelectorAll(".svg-elem-10").forEach(function(paint4) {
    paint4.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 5
document.querySelectorAll(".svg-elem-11").forEach(function(paint5) {
    paint5.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 6
document.querySelectorAll(".svg-elem-40").forEach(function(paint6) {
    paint6.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 7
document.querySelectorAll(".svg-elem-41").forEach(function(paint7) {
    paint7.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});

// Paint color Target 8
document.querySelectorAll(".svg-elem-14").forEach(function(paint8) {
    paint8.addEventListener("mouseenter", function() {
    gsap.effects.colorize2(this);
  });
});


//MOTION PATHS

// Declare boat 1 timeline
let tl_b1 = gsap.timeline();

//Boat 1 Function
function boat1(){

// tl_b1.set(".svg-elem-39", {scale: 1, autoAlpha: 1});

  var action =  tl_b1.to(".svg-elem-39", {

     // display: "inline",
      duration: 14,
      repeat: -1,
      delay:2.2,
      repeatDelay: 6,
      //stroke: mycolor,
      fill: rnum_var,
      opacity: 0.9, 
      yoyo: false,
      ease: rnum_eases,
      immediateRender: true,
      repeatRefresh: true,
      
      motionPath: {
                 path: "#path",
                 align: "#path",
                 alignOrigin: [0, 1],
                 autoRotate: 0
                }          
           });
           
  //Flag Colors on repeat          
  var flag=document.querySelector(".flag");

  gsap.to(flag, {duration: 14, repeat: 50, repeatRefresh: true, fill: "#8c8cf9d4"});     
  
  gsap.utils.toArray(".svg-elem-39").forEach(Boat_1 => {
  //Boat1:hover effect
  let hover = gsap.to(".svg-elem-39", {scale: 2.50, color: "#8080e9", fill: "#8c8cf9", duration: 0.6, paused: true, ease: "power1.inOut"});
  
  Boat_1.addEventListener("mouseenter", () => hover.play());
  Boat_1.addEventListener("mouseleave", () => hover.reverse());

});

 // Boat 1 Timeline controls
 var hover_boat1 = document.querySelector(".svg-elem-39");

 hover_boat1.addEventListener("mouseenter", function (){ 

    tl_b1.pause(); 
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Clicca per cambiare schema colore (3) 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});
  
    //WIDGET
    //widgetContent();
    openWidget();    
    //Show widget
    gsap.to(".rect", {duration: 2, autoAlpha: 1, delay: 0});
    //Show random widget text
   // gsap.to("#my_text", {duration: 1, scrambleText: {text: widget_msg, chars: "xo", revealDelay: 0.5, speed: 0.3}});  
}); 


hover_boat1.addEventListener("click", function (){ 
    
     // gsap.effects.colorize5(".st1, .st5, .st6, .st7, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41");

      gsap.to(".st1, .st5, .st6, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41", {
      fill: mycolor,
      stagger: function(index, target, list) {
      // your custom logic here. Return the delay from the start (not between each)
       return index * 0.1;
      }
    });
   
      gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Usa il pennello 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});
      
      //Show Rain
      gsap.to(".droplet", {duration:4, autoAlpha: 1})
      
      //Audio
     // music_player.pause();
      //Show Audio controls and hide logos + fix flag + hamburger
      gsap.set("#flag1", { top:"13.5%", autoAlpha: 0, position: "absolute"});
      gsap.to("#flag1", {delay:1, duration: 0.6, top:"12.5%", autoAlpha: 1, position: "absolute"});
    //gsap.to(".partner-logo", {duration: 1, autoAlpha: 0});
      gsap.to(".wrapper_menu", {duration: 1, autoAlpha: 0});
     // gsap.to("#music", {display:"inline", duration: 1, autoAlpha: 1, delay: 0.7});
      //Show Audio top controls
     // gsap.to("#audio-top", {display:"inline", duration: 1, autoAlpha: 1, delay: 0.7});
      //Hide birds
      //gsap.to("#canvas2", {display:"inline", duration: 1, autoAlpha: 0, delay: 0.7});
        
});

hover_boat1.addEventListener("mouseleave", function (){ 
    
    tl_b1.resume();
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Colora la città o posizionati su un'altra barca 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    //WIDGET
    
    //Hide random widget text
   // gsap.to("#my_text", {duration: 1, scrambleText: {text: "", chars: "xo", revealDelay: 0.5, speed: 0.2}});
    //Hide widget
   // gsap.to(".rect", {duration: 2, autoAlpha: 0, delay: 0});

    closeWidget();
   
});

let container = document.querySelector(".info_container");

}// end Boat 1 fun


 // Declare boat 2 timeline
let tl_b2 = gsap.timeline();

//Boat 2 Function
function boat2(){

tl_b2.set(".svg-elem-36", {scale: 1, autoAlpha: 1});

  var action =  tl_b2.from(".svg-elem-36", {

      duration: 12,
      repeat: -1,
      delay:2.8,
      repeatDelay: 3.8,
      //stroke: mycolor,
      fill: rnum_var,
      opacity: 1, 
      yoyo: false,
      ease: rnum_eases2,
      immediateRender: true,
      repeatRefresh: true,
     // onRepeat:rnum,
      motionPath: {
                 path: "#path2",
                 align: "#path2",
                 alignOrigin: [0, 1],
                 autoRotate: 0
                }          
           });
              
           
  gsap.utils.toArray(".svg-elem-36").forEach(Boat_2 => {
  //Boat2:hover effect
  let hover = gsap.to(".svg-elem-36", {scale: 2.5, color: "#8080e9", fill: "#8c8cf9", duration: 0.6, paused: true, ease: "power1.inOut"});
  
  Boat_2.addEventListener("mouseenter", () => hover.play());
  Boat_2.addEventListener("mouseleave", () => hover.reverse()); 
  
});

// Boat 2 Timeline controls
var hover_boat2 = document.querySelector(".svg-elem-36");

hover_boat2.addEventListener("mouseenter", function (){ 

    tl_b2.pause(); 
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Clicca per cambiare la combinazione dei colori (6) 🟣 ", chars: "xo", revealDelay: 0.5, speed: 0.3}});
    
    openWidget();
}); 

hover_boat2.addEventListener("click", function (){ 
    
   // gsap.effects.colorize5(".st1, .st5, .st6, .st7, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41");
   
   gsap.to(".st1, .st5, .st6, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41", {
      fill: rnum_var3,
      stagger: function(index, target, list) {
      
       return index * 0.1;
      }
    });
   
   gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Dipingi con il pennello 🖌️", delimiter: " ", chars: "xo", revealDelay: 0.5, speed: 0.3}});

  
  // closeWidget();

      //Audio set on listener
      //music_player.play();
      
      //Show Audio controls and hide logos + fix flag + hamburger
      gsap.to("#flag1", {duration: 0.1, top:"12.9%", autoAlpha: 0, position: "absolute"});
      gsap.to("#flag1", {delay:1, duration: 0.6, top:"12.6%", autoAlpha: 1, position: "absolute"})
      //gsap.to(".partner-logo", {duration: 1, autoAlpha: 0});
      gsap.to(".wrapper_menu", {duration: 1, autoAlpha: 0});
    //  gsap.to("#music", {display:"inline", duration: 1, autoAlpha: 1, delay: 0.7}); 
      //Show Audio top controls
    //  gsap.to("#audio-top", {display:"inline", duration: 1, autoAlpha: 1, delay: 0.7});

      //Hide birds
    //  gsap.to("#canvas2", {display:"inline", duration: 1, autoAlpha: 0, delay: 0.7});
      //Hide rain
      gsap.to(".droplet", {duration:3, autoAlpha: 0});

});

hover_boat2.addEventListener("mouseleave", function (){ 
    
    tl_b2.resume();
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Colora la città o posizionati su un'altra barca 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});
   
    closeWidget();
});

}// end Boat 2 fun


// Declare boat 3 timeline
let tl_b3 = gsap.timeline();

//Boat 3 Function
function boat3(){

tl_b3.set(".svg-elem-42", {scale: 1, autoAlpha: 1});

var mycolor = gsap.utils.random(["#8c8cf9ab", "#8cabf9de", "#8080e9"], true);

  var action =  tl_b3.to(".svg-elem-42", {

      duration: 12.50,
      delay: 7,
      repeat: -1,
      repeatDelay: 4,
      //stroke: mycolor,
      fill: rnum_var,
      opacity: 0.9, 
      yoyo: false,
      ease: rnum_eases3,
      immediateRender: true,
      repeatRefresh: true,
     // onRepeat:rnum,
      motionPath: {
                 path: "#path3",
                 align: "#path3",
                 alignOrigin: [0, 1],
                 autoRotate: 0
                }          
           });
              
        
  
  gsap.utils.toArray(".svg-elem-42").forEach(Boat_3 => {
  //Boat3:hover effect
  let hover = gsap.to(".svg-elem-42", {scale: 2.5, color: "#8c8cf9", fill: "#8c8cf9", duration: 0.6, paused: true, ease: "power1.inOut"});
  
  Boat_3.addEventListener("mouseenter", () => hover.play());
  Boat_3.addEventListener("mouseleave", () => hover.reverse()); 
  
});

// Boat 3 Timeline controls
var hover_boat3= document.querySelector(".svg-elem-42");

hover_boat3.addEventListener("mouseenter", function (){ 

    tl_b3.pause(); 
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Azzera i colori in città con un click 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    //WIDGET
    openWidget();
    
    //Show widget
   // gsap.to(".rect", {duration: 2, autoAlpha: 1, delay: 0});

    //Show random widget text
   // gsap.to("#my_text", {duration: 1, scrambleText: {text: msg_ran, chars: "xo", revealDelay: 0.5, speed: 0.3}});

}); 

hover_boat3.addEventListener("click", function (){ 
    
   //Reset City Colors
    gsap.effects.colorize7(".st1, .st5, .st6, .st7, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, svg-elem-29, svg-elem-30, .svg-elem-40, .svg-elem-41");

    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Dipingi con il pennello 🖌️ ", chars: "xo", revealDelay: 0.5, speed: 0.3}});
    
    //Hide random widget text
   // gsap.to("#my_text", {duration: 1, scrambleText: {text: "", chars: "xo", revealDelay: 0.5, speed: 0.2}});
    //Hide widget
   // gsap.to(".rect", {duration: 2, autoAlpha: 0, delay: 0});

   closeWidget();
      
    //Hide Rain
    gsap.to(".droplet", {duration:4, autoAlpha: 0});

      //Pause audio
     // music_player.pause();
     //Hide Audio Player and show logos + adjust flag + hamburger
     // gsap.to("#music", {duration: 1, autoAlpha: 0, display:"none"});
     // gsap.to(".partner-logo", {duration: 0.9, autoAlpha:1, delay: 1.2});
     // gsap.to(".wrapper_menu", {delay: 1.8, duration: 0.8, autoAlpha: 1});
     
      //Fix flag
      gsap.to("#flag1", {duration: 0.1, top:"11.95%", autoAlpha: 0, position: "absolute"});
      gsap.to("#flag1", {delay:1, duration: 0.6, top:"12.25%", autoAlpha: 1, position: "absolute"})
      //Hide Audio top controls
      //  gsap.to("#audio-top", {display:"inline", duration: 1, autoAlpha: 0, delay: 0.7});
      
      //Show birds
     // gsap.to("#canvas2", {display:"inline", duration: 2, autoAlpha: 1, delay: 0.7});
});

hover_boat3.addEventListener("mouseleave", function (){ 
    
    tl_b3.resume();

    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Colora la città o posizionati su un'altra barca 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    gsap.to("#msg_text3", {duration: 1, scrambleText: {text: "Elementi dipinti 0 su 30", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    //Hide random widget text
   // gsap.to("#my_text", {duration: 1, scrambleText: {text: "", chars: "xo", revealDelay: 0.5, speed: 0.2}});
    
    
    //Hide widget
    //gsap.to(".rect", {duration: 2, autoAlpha: 0, delay: 0});

    closeWidget();

});

}// end Boat 3 fun


//Flag
const flag1 = document.querySelector ('#flag1');

function flag_box(){

var flag=document.querySelector(".flag");

gsap.set(flag, {xPercent: -50}); 
gsap.to(flag, {delay:0, duration: 1.5, xPercent:0, repeat:-1, ease:'none' });

}

var boat = document.querySelector(".svg-elem-42");
var tl_widget = new TimelineMax();
var tl_widget_img = new TimelineMax();


//WIDGET INFO
function infoWindget() {

tl_widget.reverse();
tl_widget.pause();
tl_widget_img.reverse();
tl_widget_img.pause();

gsap.to(".rect", {duration: 2, autoAlpha: 0, delay: 0});

//set the initial position and transform-origin
TweenMax.set(".rect", {transformOrigin: "50% 50%", x:290, y:-185});

//fade and scale up
tl_widget.fromTo(".rect", 0.4, {opacity:0, scale:0.1}, {opacity:1, scaleX:0.38, scaleY:0.15, ease:Power2.easeIn})
  //morph to the bowed shape
  .to(".rect", 0.2, {morphSVG:".bowedRect"}, "-=0.1")
  //morph back to the original, but with elastic easing to give it a fun effect.
  .to(".rect", 1, {morphSVG:".rect", ease:Elastic.easeOut});

  tl_widget_img.fromTo("#widget_img", 0.4, {opacity:0, scale:0.1}, { delay:0.2, opacity:0.9, scaleX:1, scaleY:1, ease:Power2.easeIn});
} 

// Widget Functions

function openWidget() {

    //WIDGET
    tl_widget.play();
    tl_widget_img.play();
    
 // Widget array
 let widgetList = [{"id":"1", "url":"123", "msg":"JS Senior Developers", "img":" img/widget/js.jpg"} , {"id":"2","url":"abc", "msg":"Wordpress Websites", "img":" img/widget/wp.png"}, {"id":"3","url":"#link_test", "msg":"Manage Projects", "img":" img/graphics/widgets/mini-widget-1-night.png"}, {"id":"4","url":"#link2_test", "msg":"ProcessWire CMS", "img":" img/widget/pw.png"}, {"id":"5","url":"about", "msg":"Workflow", "img":" img/graphics/icons/robotics-1-core.svg"}, {"id":"6","url":"#", "msg":"Sviluppo Front End", "img":" img/graphics/icons/robotics-2-core.svg"}, {"id":"7","url":"#", "msg":"Prototyping", "img":" img/graphics/icons/robotics-3-core.svg"}, {"id":"8","url":"#", "msg":"Client/Server software", "img":" img/graphics/icons/robotics-4-core.svg"},
  {"id":"9","url":"servizi-web/website-redesigns/", "msg":"Website Redesigns", "img":" img/website-redesign3.png"}, 
  {"id":"10","url":"servizi-web/realizzazione-sito-web-responsivo/", "msg":"Siti Web Responsivi", "img":" img/siti-web-responsivi.png"}]

//WIDGET RANDOM CONTENT  

const widgetImg = document.querySelector('#widget_img');
const widgetUrl = document.querySelector('#widget_link');

var i = Math.floor(Math.random() * 10);

//Show vars
widgetImg.src = widgetList[i].img;
widgetUrl.href = widgetList[i].url;

//Store vars
var widget_msg = widgetList[i].msg;
var widget_img = widgetList[i].img;
var widget_url = widgetList[i].url;

     //Show widget
     gsap.to(".rect", {duration: 2, autoAlpha: 1, delay: 0});

    //Show random widget text from array object
    gsap.to("#my_text", {duration: 1, scrambleText: {text: widget_msg, chars: "xo", revealDelay: 0.4, speed: 0.3}});
    
    var tl_widget_link = new TimelineMax();

    //Smart link logic
    if(widget_url != "#"){

    tl_widget_link.to("#smartLinkContainer", {duration: 0.6, autoAlpha: 1, delay: 0});
    tl_widget_link.to("#widget_link", {duration: 1, scrambleText: {text: widget_msg, chars: "", revealDelay: 0.3, speed: 0.3}});

  }else if(widget_url == "#"){
    
    tl_widget_link.to("#smartLinkContainer", {duration: 0.6, autoAlpha: 0, delay: 0});
    tl_widget_link.to("#widget_link", {duration: 1, scrambleText: {text: "", chars: "", revealDelay: 0.3, speed: 0.3}});

  }

  }// end openWidget()

function closeWidget() {
    
    //WIDGET
    tl_widget.reverse();
    tl_widget_img.reverse();
    
    //Hide random widget text
    gsap.to("#my_text", {duration: 1, scrambleText: {text: "", chars: "xo", revealDelay: 0.5, speed: 0.2}});
    //Hide widget
    gsap.to(".rect", {duration: 2, autoAlpha: 0, delay: 0});
}


//MAIN

 //City Start
 //cityStart();
 //InitiateSpeedDetection();
 //Boats Start  
   

//InfoWidget init
 infoWindget();

 
//PAGE LISTENERS

//Flag status
var flag = document.querySelector("#flag1");

    //Hover
    flag.addEventListener("mouseenter", function (){
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Clicca per generare gli Splat (´◡`)", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    }); 

    //Leave
    flag.addEventListener("mouseleave", function (){
    gsap.to("#msg_text", {duration: 0.8, scrambleText: {text: "Micro-interazioni (´◡`)", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    }); 

    //Click
    flag.addEventListener("click", function (){
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Splat generati 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    multipleSplats(parseInt(Math.random() * 4) + 3);

     }); 

     //City leave message
     var city_layout = document.querySelector("#Layer_1");
     city_layout.addEventListener("mouseleave", function (){
     gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Micro-interazioni (´◡`)", chars: "xo", revealDelay: 0.5, speed: 0.3}});

    });
  
// SPEED TEST

     

//Rain
function rain() {

var dropletQuantity = 50;

for (var i = dropletQuantity - 1; i >= 0; i--) {
  
  var pos = Math.floor((Math.random() * 100) + 1);
  var delay = Math.random();
  var speed = (Math.random() * 0.5) + 0.2;
  
  droplet = document.createElement("div");
  droplet.className = "droplet";
  droplet.style.left = pos + "%";
  
  gsap.to(droplet, speed, { y :520, delay : delay, repeat:-1,ease:Linear.easeNone});
  
  document.getElementById('svg_container').appendChild(droplet);
}

}//end rain function




    
     //SMART LINKS LISTENERS

     //Hamburger******************************

     //Boat1 + adjust hamburger
     document.getElementById("boat1_target").addEventListener('click', function() {
      //adjust hamburger
   // gsap.to(".wrapper_menu", {delay: 0, duration: 0, y: "-40px"});

    //console.log(e.target.value);
     gsap.to(".st1, .st5, .st6, .st7, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41", {
      fill: mycolor,
      stagger: function(index, target, list) {
      // your custom logic here. Return the delay from the start (not between each)
       return index * 0.1;
      }
    });
   
      gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Usa il pennello 🟣", chars: "xo", revealDelay: 0.5, speed: 0.3}});
      
      //Start Rain
      rain();
         
      //Audio
      //thisTrack.pause();
      //Show Audio controls and hide logos + adjust flag
      gsap.to("#flag1", {duration: 0.1, top:"17.2%", autoAlpha: 0, position: "absolute"});
      gsap.to("#flag1", {delay:1, duration: 0.6, top:"15.2%", autoAlpha: 1})
      gsap.to(".city-hero", {duration: 1, autoAlpha: 0});
      //gsap.to("#music", {display:"inline", duration: 1, autoAlpha: 1, delay: 0.7});
 
     });

      //Boat2
      document.getElementById("boat2_target").addEventListener('click', function() {

      gsap.to(".st1, .st5, .st6, .st7, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41", {
      fill: rnum_var2,
      stagger: function(index, target, list) {
      
       return index * 0.1;
      }
    });
   
   gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Dipingi con il pennello 🖌️", delimiter: " ", chars: "xo", revealDelay: 0.5, speed: 0.3}});

  
   closeWidget();

         //Audio set on fun listener
        //thisTrack.pause();
      
      //Show Audio controls and hide logos + adjust flag
      gsap.to("#flag1", {duration: 0.1, top:"17.2%", autoAlpha: 0, position: "absolute"});
      gsap.to("#flag1", {delay:1, duration: 0.6, top:"15.2%", autoAlpha: 1})
      gsap.to(".city-hero", {duration: 1, autoAlpha: 0});
      //gsap.to("#music", {display:"inline", duration: 1, autoAlpha: 1, delay: 0.7});
 });

    //RESET
    document.getElementById("boat3_target").addEventListener('click', function() {

    //Reset City Colors
    gsap.effects.colorize6(".st1, .st5, .st6, .st7, .svg-elem-1, .svg-elem-10, .svg-elem-11, .svg-elem-12, .svg-elem-17, .svg-elem-18, .svg-elem-40, .svg-elem-41");
    gsap.to("#msg_text", {duration: 1, scrambleText: {text: "Dipingi con il pennello 🖌️ ", chars: "xo", revealDelay: 0.5, speed: 0.3}});
    
    //Hide random widget text
    gsap.to("#my_text", {duration: 1, scrambleText: {text: "", chars: "xo", revealDelay: 0.5, speed: 0.2}});
    //Hide widget
    gsap.to(".rect", {duration: 2, autoAlpha: 0, delay: 0});
      
    //Stop Rain
    gsap.to(".droplet", 0, {duration:2, autoAlpha: 0});

     // Pause audio
      //thisTrack.pause();
     //Hide Audio Player and show logos + adjust flag
     // gsap.to("#music", {duration: 1, autoAlpha: 0, display:"none"});
      gsap.to(".city-hero", {duration: 0.9, autoAlpha:1, delay: 1.2});
      gsap.to("#flag1", {top:"18%"});
      //Fix flag
      gsap.to("#flag1", {duration: 0.1, top:"17.8%", autoAlpha: 0, position: "absolute"});
      gsap.to("#flag1", {delay:1, duration: 0.5, top:"17.8%", autoAlpha: 1})
    });

    //Left Smart Links************************************************


//CHECKING FOR WHITE COLOR
//BALLON
//START BOATS 
let tl_ballon = gsap.timeline();
tl_ballon.pause();
tl_ballon.set("svg", { opacity: 1 });

tl_ballon.to("#circle50", {
keyframes: {
  "0%": { yPercent: 0, scaleX: 1, scaleY: 1 },
  "7%": { yPercent: 5, scaleY: 0.9, scaleX: 1.1, ease: "sine.in" },
  "25%": { yPercent: 50, scaleY: 1.15, scaleX: 0.9, ease: "sine.in" },
  "50%": { yPercent: 250, scaleX: 1, scaleY: 1, ease: "none" },
  "60%": { scaleX: 1.6, scaleY: 0.4, ease: "none" },
  "65%": { yPercent: 250, scaleX: 1, scaleY: 1 },
  "100%": { yPercent: 0, scaleX: 1, scaleY: 1 },
  easeEach: "sine.out"
},
duration: 0.8,
repeat: -1,
transformOrigin: "center bottom"
});


function getWhite(){

  var st6 = document.querySelectorAll("#path84, #path86, #path82, #path964, #path962, #path4, #path8, #path10, #path12, #path14, #path16, #path18, #path20, #path22, #path24, #path30, #path32, #path34, #path40, #path42, #path44, #path46, #path48, #circle50, #path52, #circle54, #path56, #path58, #path64, #path66, #path68, #path80, #path88");
  var st6Length = st6.length;
  var elementPainted = 0;


 for (var i = 0; i < st6.length; ++i) {

  var st6Style = window.getComputedStyle(st6[i], null).fill;

    
    if(st6Style === "rgb(255, 255, 255)" || st6Style === "rgba(237, 237, 237, 0.99)"  || st6Style === "rgba(245, 245, 245, 0.94)" || st6Style === "rgba(245, 245, 245, 0.92)") {

     // tl_ballon.restart()
     // tl_ballon.pause();
   
  // alert("There is White" + " " + st6Style + " " + i + " " + st6Length);
 
  }else{


   //alert("There is NO White!" + " " + st6Style + " " + i + " " + st6Length);

   //element painted counter
   elementPainted++ ;

   document.getElementById('msg_text3').innerHTML = "Elementi dipinti " +  elementPainted + " su " + (st6Length-3);
  
   //ELEMENTS PAINTED ACTIONS
   if(elementPainted == 30){

   

    gsap.to(".svg-elem-36", {opacity: 1, display: "inline", duration: 3});
    gsap.to(".svg-elem-39", {opacity: 1, display: "inline", duration: 3});
    gsap.to(".svg-elem-42", {opacity: 1, display: "inline", duration: 3});

    document.getElementById('msg_text3').innerHTML = "Elementi dipinti " +  elementPainted + " su " + (st6Length-3)  + " 😉 ";
   
    tl_ballon.restart();
    tl_ballon.pause();

   }else if(elementPainted > 28 ){
    
    tl_ballon.play();  
  
  }else if(elementPainted < 28 ){
   
    tl_ballon.restart();
    tl_ballon.pause();  
  }


  }

}

setTimeout(getWhite, 800);

}// end getWhite

//getWhite() Start
getWhite();

rain();
gsap.to(".droplet", 0, {duration:0, autoAlpha: 0});




//PORTFOLIO SCROLL

const images = gsap.utils.toArray('img');
const loader = document.querySelector('.loader--text');
const updateProgress = (instance) => 
  loader.textContent = `${Math.round(instance.progressedCount * 100 / images.length)}%`;

const showDemo = () => {
  document.body.style.overflow = 'auto';
  document.scrollingElement.scrollTo(0, 0);
  gsap.to(document.querySelector('.loader'), { autoAlpha: 0 });
  
  gsap.utils.toArray('section').forEach((section, index) => {
    const w = section.querySelector('.wrapper');
    const [x, xEnd] = (index % 2) ? ['100%', (w.scrollWidth - section.offsetWidth) * -1] : [w.scrollWidth * -1, 0];
    gsap.fromTo(w, {  x  }, {
      x: xEnd,
      scrollTrigger: { 
        trigger: section, 
        scrub: 0.5 
      }
    });
  });
}

imagesLoaded(images).on('progress', updateProgress).on('always', showDemo);




//PAGE TRANSITION

function logoStart() {
   
   let tl = gsap.timeline({

repeatRefresh: false, // invalidates on each repeat
yoyo: false,
//onStart: cityStart,
defaults: {
ease: "none" 
}
});     
        
		tl.set(".header-body", {opacity:0});
    tl.set(".logo-color", {opacity:0});
		tl.set("#img-home", {opacity:0.7}); 
             
    tl.to("#header-img-overlay", 1.6, { top:"-105%", ease: Power3.easeInOut})
		.to("#img-home", {delay: 0, opacity:1, duration: 0.2 }, 1)
		.to(".header-body", {delay: 0, opacity:1, duration: 1.2 }, 1);
		//.to(".logo-color", {delay: 0, opacity:1, duration: 1.8 }, 1);

    } //end logoStart()

    logoStart();

//INTRO ANIMATION

function introStart(){
  
  //overflowY Start
  gsap.to("html", {duration: 0, delay: 0.8, overflowY:"hidden"});

    $(function() {
  "use strict";

  var quotes = [
    "Did you smile today yet? My dog certainly did.",
  ];

  $('.quote').html(quotes[Math.floor(Math.random() * quotes.length)]);
  TweenLite.fromTo('.quote', .7, {
    alpha: 0,
    y: '-20px'
  }, {
    alpha: 1,
    y: '0',
    ease: Power2.easeOut
  });

  var aboutAnimation = new TimelineMax({repeat:0});
  aboutAnimation
    .set('.load', { opacity: 0 })
    .to('.load', 0.8, {
      opacity: 1,
      y: '-40%',
    })
    .to('.load', .25, {
      autoAlpha: 0,
    })
    .from('.aboutAni', 1, {
      scale: 1,
      autoAlpha: 0,
      y: '20px',
      width: '100px',
      height: '20px',
      ease: Elastic.easeOut.config(1, 0.5),
    })
    .from('.text-design', .3, {
      autoAlpha: 0,
      y: '-20px',
      ease: Power3.easeOut
    })
    .from('.head', .5, {
      autoAlpha: 0,
      y: '-20px',
      ease: Power3.easeOut
    })
    .staggerFrom('.box', .5, {
      autoAlpha: 0,
      y: '-20px',
      ease: Power3.easeOut
    }, '.15', '-=.3')
    .to('.text-design', .3, {
      display: 'none',
      autoAlpha: 0,
      y: '20px',
      ease: Power3.easeIn,
      delay: .5
    })
    .to('.design', .5, {
      autoAlpha: 0,
      y: '20px',
      ease: Power3.easeIn,
      display: 'none'
    })
    .to('.aboutAni', 1, {
      scale: '.3',
     rotation: '360deg',
      ease: Power3.easeIn
    }, '-=.5')
    .to('.aboutAni', 1, {
      scale: '1',
      rotation: '720deg',
      ease: Power3.easeOut
    })
    .from('.text-develop', .3, {
      display: 'none',
      autoAlpha: 0,
      y: '-20px',
      ease: Power3.easeOut
    }, '-=.5')
    .from('.develop', .5, {
      autoAlpha: 0,
      ease: Power3.easeOut
    }, '-=1')
    .from('.sidebar', .5, {
      autoAlpha: 0,
      ease: Power3.easeOut,
      x: '-20px'
    }, '-=.3')
    .staggerFrom('.line', .3, {
      autoAlpha: 0,
      y: '-20px',
      ease: Power4.easeOut
    }, '.15', '-=.3')
    .to('.text-develop', .3, {
      display: 'none',
      autoAlpha: 0,
      y: '20px',
      ease: Power3.easeIn,
      delay: .7
    })
    .to('.develop', .5, {
      autoAlpha: 0,
      y: '20px',
      ease: Power3.easeIn
    }, '-=.3')
    .to('.aboutAni', 1, {
      borderRadius: '25px',
      width: '50px',
      height: '50px',
      top: '50%',
      y: '-50%',
      ease: Elastic.easeInOut.config(1, 0.75)
    })
    .to('.aboutAni', .3, {
      autoAlpha: 0
    }, '-=.3')
    .fromTo('.browser', 1, {
      autoAlpha: 0,
      scale: .5
    }, {
      autoAlpha: 1,
      scale: 1,
      y: '-50%',
      borderRadius: '50%',
      ease: Elastic.easeOut.config(1, 0.75)
    }, '-=1')
    .to('.browser', 1, {
      width: '100%',
      height: '210px',
      borderRadius: '5px',
      delay: 1,
      ease: Elastic.easeOut.config(1, 0.75)
    }, '-=.5')
    .fromTo('.text-screen', .3, {
      autoAlpha: 0,
      y: '-10px'
    }, {
      autoAlpha: 1,
      y: '0'
    }, '-=.5')
    .to('.icon', .3, {
      autoAlpha: 0,
      display: 'none',
      ease: Power3.easeIn
    })
    .fromTo('.header', .3, {
      autoAlpha: 0,
      y: '-10px'
    }, {
      autoAlpha: 1,
      y: '0'
    })
    .to('.header, .body', .3, {
      autoAlpha: 0,
      y: '10px',
      display: 'none',
      delay: 1.2
    })
    .to('.browser', 1, {
      width: '200px',
      ease: Elastic.easeOut.config(1, 0.75)
    })
    .fromTo('.tablet', .3, {
      autoAlpha: 0,
      y: '-10px'
    }, {
      autoAlpha: 1,
      y: '0'
    }, '-=.3')
    .to('.tablet', .3, {
      autoAlpha: 0,
      y: '10px',
      display: 'none',
      delay: .7
    })
    .to('.browser', 1, {
      width: '90px',
      height: '160px',
      ease: Elastic.easeOut.config(1, 0.75)
    })
    .fromTo('.phone', .3, {
      autoAlpha: 0,
      y: '-10px'
    }, {
      autoAlpha: 1,
      y: '0'
    }, '-=.5')
    .to('.text-screen', .3, {
      autoAlpha: 0,
      y: '10px',
      display: 'none',
      delay: .7
    })
    .fromTo('.text-web', .3, {
      autoAlpha: 0,
      y: '-10px'
    }, {
      autoAlpha: 1,
      y: '0'
    })
    .to('.phone', .3, {
      autoAlpha: 0,
      y: '10px',
      display: 'none'
    })
    .to('.body', 0, {
      autoAlpha: 1,
      y: '0',
      display: '',
      height: '100%',
      padding: 0
    })
    .to('.browser', .5, {
      width: '10px',
      height: '10px',
      ease: Power3.easeIn
    })
    .to('.browser', .5, {
      width: '200px',
      height: '200px',
      borderRadius: '5px',
      ease: Elastic.easeOut.config(1, 0.75)
    })
    .fromTo('.heart span', .5, {
      autoAlpha: 0
    }, {
      autoAlpha: 1,
      fontSize: '100px',
      ease: Elastic.easeOut.config(1, 0.75)
    })
    .to('.heart', .3, {
      autoAlpha: 0,
      y: '10px',
      display: 'none',
      delay: .7
    })
    .to('.text-web', .3, {
      autoAlpha: 0,
      y: '10px',
      display: 'none'
    })
    .to('.browser', 1, {
      width: '200px',
      height: '60px',
      borderRadius: '5px',
      ease: Elastic.easeOut.config(1, 0.75)
    }, '-=.5')
    .fromTo('.more', .3, {
      alpha: 0,
      y: '-80%',
      display: ''
    }, {
      autoAlpha: 1,
      y: '-50%'
    })
    .to('.more', .3, {
      alpha: 0,
      y: '10px',
      display: 'none',
      delay: 1.5,
      onComplete: function() {
 
      // window.location.href = "https://livedata.it/ldata2022/about/";  
     
        document.cookie = "userActive = 1;";

       // gsap.to(window, {duration: 1.5, scrollTo:"#firstSection"});
       gsap.to("#scene_1", {duration: 0, display:"contents"});
       gsap.to("#introStart", {delay:0, duration: 0, display:"none"});
       gsap.fromTo("#firstSection", {opacity: 0}, {opacity: 1, delay:0, duration: 0.6});
       gsap.to("html", {duration: 0, overflowY:"scroll"});
       //Callback from Intro
              
    
}
    })
    .to('.browser', 0, {
      maxWidth: 'initial',
      maxHeight: 'initial'
    })
    .to('.browser', 0.2, {
      width: '100%',
      height: '100%',
      backgroundColor: '#fff',
      borderRadius: '0%',
      ease: Power4.easeOut
    })
    .to('.browser', .2, {
      opacity: 0,
      ease: Power4.easeOut
    })
    .set('.browser-wrap', {
      autoAlpha: 0,
      backgroundColor: '#fff',
      display: 'none'
    })
    .set('.about', {
      autoAlpha: 1,
      y: '0',
      display: '',
     // onStart: cityStart,
    });
  
  $(window).resize(function() {
    $('.browser-height').height($(this).height());
  })
  $(window).resize();

});

}//end function intro




//MOUSE BG EFFECT

'use strict';
const canvas = document.querySelector("#canvas3");
resizeCanvas();

let config = {
    SIM_RESOLUTION: 128,
    DYE_RESOLUTION: 1024,
    CAPTURE_RESOLUTION: 512,
    DENSITY_DISSIPATION: 0.58,
    VELOCITY_DISSIPATION: 0.57,
    PRESSURE: 0.9,
    PRESSURE_ITERATIONS: 25,
    CURL: 1,
    SPLAT_RADIUS: 0.01,
    SPLAT_FORCE: 6000,
    SHADING: true,
    COLORFUL: true,
    COLOR_UPDATE_SPEED: .9,
    BACK_COLOR: { r: 255, g: 255, b: 255 },
    TRANSPARENT: true,
    SUNRAYS: true,
    SUNRAYS_RESOLUTION: 196,
    SUNRAYS_WEIGHT: 1.0,
}

function pointerPrototype () {
    this.id = -1;
    this.texcoordX = 0;
    this.texcoordY = 0;
    this.prevTexcoordX = 0;
    this.prevTexcoordY = 0;
    this.deltaX = 0;
    this.deltaY = 0;
    this.down = false;
    this.moved = false;
    this.color = [30, 0, 300];
}

var pointers = [];
var splatStack = [];
pointers.push(new pointerPrototype());

var ref = getWebGLContext(canvas);
var gl = ref.gl;
var ext = ref.ext;

if (!ext.supportLinearFiltering) {
    config.DYE_RESOLUTION = 512;
    config.SHADING = false;
    config.BLOOM = false;
    config.SUNRAYS = false;
}


function getWebGLContext (canvas) {
    var params = { alpha: true, depth: false, stencil: false, antialias: false, preserveDrawingBuffer: false };

    var gl = canvas.getContext('webgl2', params);
    var isWebGL2 = !!gl;
    if (!isWebGL2)
        { gl = canvas.getContext('webgl', params) || canvas.getContext('experimental-webgl', params); }

    var halfFloat;
    var supportLinearFiltering;
    if (isWebGL2) {
        gl.getExtension('EXT_color_buffer_float');
        supportLinearFiltering = gl.getExtension('OES_texture_float_linear');
    } else {
        halfFloat = gl.getExtension('OES_texture_half_float');
        supportLinearFiltering = gl.getExtension('OES_texture_half_float_linear');
    }

    gl.clearColor(0.0, 0.0, 0.0, 1.0);

    var halfFloatTexType = isWebGL2 ? gl.HALF_FLOAT : halfFloat.HALF_FLOAT_OES;
    var formatRGBA;
    var formatRG;
    var formatR;

    if (isWebGL2)
    {
        formatRGBA = getSupportedFormat(gl, gl.RGBA16F, gl.RGBA, halfFloatTexType);
        formatRG = getSupportedFormat(gl, gl.RG16F, gl.RG, halfFloatTexType);
        formatR = getSupportedFormat(gl, gl.R16F, gl.RED, halfFloatTexType);
    }
    else
    {
        formatRGBA = getSupportedFormat(gl, gl.RGBA, gl.RGBA, halfFloatTexType);
        formatRG = getSupportedFormat(gl, gl.RGBA, gl.RGBA, halfFloatTexType);
        formatR = getSupportedFormat(gl, gl.RGBA, gl.RGBA, halfFloatTexType);
    }


    return {
        gl: gl,
        ext: {
            formatRGBA: formatRGBA,
            formatRG: formatRG,
            formatR: formatR,
            halfFloatTexType: halfFloatTexType,
            supportLinearFiltering: supportLinearFiltering
        }
    };
}

function getSupportedFormat (gl, internalFormat, format, type)
{
    if (!supportRenderTextureFormat(gl, internalFormat, format, type))
    {
        switch (internalFormat)
        {
            case gl.R16F:
                return getSupportedFormat(gl, gl.RG16F, gl.RG, type);
            case gl.RG16F:
                return getSupportedFormat(gl, gl.RGBA16F, gl.RGBA, type);
            default:
                return null;
        }
    }

    return {
        internalFormat: internalFormat,
        format: format
    }
}

function supportRenderTextureFormat (gl, internalFormat, format, type) {
    var texture = gl.createTexture();
    gl.bindTexture(gl.TEXTURE_2D, texture);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
    gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, 4, 4, 0, format, type, null);

    var fbo = gl.createFramebuffer();
    gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);
    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);

    var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);
    return status == gl.FRAMEBUFFER_COMPLETE;
}



function framebufferToTexture (target) {
    gl.bindFramebuffer(gl.FRAMEBUFFER, target.fbo);
    var length = target.width * target.height * 4;
    var texture = new Float32Array(length);
    gl.readPixels(0, 0, target.width, target.height, gl.RGBA, gl.FLOAT, texture);
    return texture;
}

function normalizeTexture (texture, width, height) {
    var result = new Uint8Array(texture.length);
    var id = 0;
    for (var i = height - 1; i >= 0; i--) {
        for (var j = 0; j < width; j++) {
            var nid = i * width * 4 + j * 4;
            result[nid + 0] = clamp01(texture[id + 0]) * 255;
            result[nid + 1] = clamp01(texture[id + 1]) * 255;
            result[nid + 2] = clamp01(texture[id + 2]) * 255;
            result[nid + 3] = clamp01(texture[id + 3]) * 255;
            id += 4;
        }
    }
    return result;
}

function clamp01 (input) {
    return Math.min(Math.max(input, 0), 1);
}

function textureToCanvas (texture, width, height) {
    var captureCanvas = document.createElement('canvas');
    var ctx = captureCanvas.getContext('2d');
    captureCanvas.width = width;
    captureCanvas.height = height;

    var imageData = ctx.createImageData(width, height);
    imageData.data.set(texture);
    ctx.putImageData(imageData, 0, 0);

    return captureCanvas;
}

function downloadURI (filename, uri) {
    var link = document.createElement('a');
    link.download = filename;
    link.href = uri;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

var Material = function Material (vertexShader, fragmentShaderSource) {
    this.vertexShader = vertexShader;
    this.fragmentShaderSource = fragmentShaderSource;
    this.programs = [];
    this.activeProgram = null;
    this.uniforms = [];
};

Material.prototype.setKeywords = function setKeywords (keywords) {
    var hash = 0;
    for (var i = 0; i < keywords.length; i++)
        { hash += hashCode(keywords[i]); }

    var program = this.programs[hash];
    if (program == null)
    {
        var fragmentShader = compileShader(gl.FRAGMENT_SHADER, this.fragmentShaderSource, keywords);
        program = createProgram(this.vertexShader, fragmentShader);
        this.programs[hash] = program;
    }

    if (program == this.activeProgram) { return; }

    this.uniforms = getUniforms(program);
    this.activeProgram = program;
};

Material.prototype.bind = function bind () {
    gl.useProgram(this.activeProgram);
};

var Program = function Program (vertexShader, fragmentShader) {
    this.uniforms = {};
    this.program = createProgram(vertexShader, fragmentShader);
    this.uniforms = getUniforms(this.program);
};

Program.prototype.bind = function bind () {
    gl.useProgram(this.program);
};

function createProgram (vertexShader, fragmentShader) {
    var program = gl.createProgram();
    gl.attachShader(program, vertexShader);
    gl.attachShader(program, fragmentShader);
    gl.linkProgram(program);

    if (!gl.getProgramParameter(program, gl.LINK_STATUS))
        { throw gl.getProgramInfoLog(program); }

    return program;
}

function getUniforms (program) {
    var uniforms = [];
    var uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);
    for (var i = 0; i < uniformCount; i++) {
        var uniformName = gl.getActiveUniform(program, i).name;
        uniforms[uniformName] = gl.getUniformLocation(program, uniformName);
    }
    return uniforms;
}

function compileShader (type, source, keywords) {
    source = addKeywords(source, keywords);

    var shader = gl.createShader(type);
    gl.shaderSource(shader, source);
    gl.compileShader(shader);

    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS))
        { throw gl.getShaderInfoLog(shader); }

    return shader;
};

function addKeywords (source, keywords) {
    if (keywords == null) { return source; }
    var keywordsString = '';
    keywords.forEach(function (keyword) {
        keywordsString += '#define ' + keyword + '\n';
    });
    return keywordsString + source;
}

var baseVertexShader = compileShader(gl.VERTEX_SHADER, "\n    precision highp float;\n\n    attribute vec2 aPosition;\n    varying vec2 vUv;\n    varying vec2 vL;\n    varying vec2 vR;\n    varying vec2 vT;\n    varying vec2 vB;\n    uniform vec2 texelSize;\n\n    void main () {\n        vUv = aPosition * 0.5 + 0.5;\n        vL = vUv - vec2(texelSize.x, 0.0);\n        vR = vUv + vec2(texelSize.x, 0.0);\n        vT = vUv + vec2(0.0, texelSize.y);\n        vB = vUv - vec2(0.0, texelSize.y);\n        gl_Position = vec4(aPosition, 0.0, 1.0);\n    }\n");

var blurVertexShader = compileShader(gl.VERTEX_SHADER, "\n    precision highp float;\n\n    attribute vec2 aPosition;\n    varying vec2 vUv;\n    varying vec2 vL;\n    varying vec2 vR;\n    uniform vec2 texelSize;\n\n    void main () {\n        vUv = aPosition * 0.5 + 0.5;\n        float offset = 1.33333333;\n        vL = vUv - texelSize * offset;\n        vR = vUv + texelSize * offset;\n        gl_Position = vec4(aPosition, 0.0, 1.0);\n    }\n");

var blurShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying vec2 vUv;\n    varying vec2 vL;\n    varying vec2 vR;\n    uniform sampler2D uTexture;\n\n    void main () {\n        vec4 sum = texture2D(uTexture, vUv) * 0.29411764;\n        sum += texture2D(uTexture, vL) * 0.35294117;\n        sum += texture2D(uTexture, vR) * 0.35294117;\n        gl_FragColor = sum;\n    }\n");

var copyShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying highp vec2 vUv;\n    uniform sampler2D uTexture;\n\n    void main () {\n        gl_FragColor = texture2D(uTexture, vUv);\n    }\n");

var clearShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying highp vec2 vUv;\n    uniform sampler2D uTexture;\n    uniform float value;\n\n    void main () {\n        gl_FragColor = value * texture2D(uTexture, vUv);\n    }\n");

var colorShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n\n    uniform vec4 color;\n\n    void main () {\n        gl_FragColor = color;\n    }\n");



var displayShaderSource = "\n    precision highp float;\n    precision highp sampler2D;\n\n    varying vec2 vUv;\n    varying vec2 vL;\n    varying vec2 vR;\n    varying vec2 vT;\n    varying vec2 vB;\n    uniform sampler2D uTexture;\n    uniform sampler2D uBloom;\n    uniform sampler2D uSunrays;\n    uniform sampler2D uDithering;\n    uniform vec2 ditherScale;\n    uniform vec2 texelSize;\n\n    vec3 linearToGamma (vec3 color) {\n        color = max(color, vec3(0));\n        return max(1.055 * pow(color, vec3(0.416666667)) - 0.055, vec3(0));\n    }\n\n    void main () {\n        vec3 c = texture2D(uTexture, vUv).rgb;\n\n    #ifdef SHADING\n        vec3 lc = texture2D(uTexture, vL).rgb;\n        vec3 rc = texture2D(uTexture, vR).rgb;\n        vec3 tc = texture2D(uTexture, vT).rgb;\n        vec3 bc = texture2D(uTexture, vB).rgb;\n\n        float dx = length(rc) - length(lc);\n        float dy = length(tc) - length(bc);\n\n        vec3 n = normalize(vec3(dx, dy, length(texelSize)));\n        vec3 l = vec3(0.0, 0.0, 1.0);\n\n        float diffuse = clamp(dot(n, l) + 0.7, 0.7, 1.0);\n        c *= diffuse;\n    #endif\n\n    #ifdef BLOOM\n        vec3 bloom = texture2D(uBloom, vUv).rgb;\n    #endif\n\n    #ifdef SUNRAYS\n        float sunrays = texture2D(uSunrays, vUv).r;\n        c *= sunrays;\n    #ifdef BLOOM\n        bloom *= sunrays;\n    #endif\n    #endif\n\n    #ifdef BLOOM\n        float noise = texture2D(uDithering, vUv * ditherScale).r;\n        noise = noise * 2.0 - 1.0;\n        bloom += noise / 255.0;\n        bloom = linearToGamma(bloom);\n        c += bloom;\n    #endif\n\n        float a = max(c.r, max(c.g, c.b));\n        gl_FragColor = vec4(c, a);\n    }\n";

var bloomPrefilterShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying vec2 vUv;\n    uniform sampler2D uTexture;\n    uniform vec3 curve;\n    uniform float threshold;\n\n    void main () {\n        vec3 c = texture2D(uTexture, vUv).rgb;\n        float br = max(c.r, max(c.g, c.b));\n        float rq = clamp(br - curve.x, 0.0, curve.y);\n        rq = curve.z * rq * rq;\n        c *= max(rq, br - threshold) / max(br, 0.0001);\n        gl_FragColor = vec4(c, 0.0);\n    }\n");

var bloomBlurShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying vec2 vL;\n    varying vec2 vR;\n    varying vec2 vT;\n    varying vec2 vB;\n    uniform sampler2D uTexture;\n\n    void main () {\n        vec4 sum = vec4(0.0);\n        sum += texture2D(uTexture, vL);\n        sum += texture2D(uTexture, vR);\n        sum += texture2D(uTexture, vT);\n        sum += texture2D(uTexture, vB);\n        sum *= 0.25;\n        gl_FragColor = sum;\n    }\n");

var bloomFinalShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying vec2 vL;\n    varying vec2 vR;\n    varying vec2 vT;\n    varying vec2 vB;\n    uniform sampler2D uTexture;\n    uniform float intensity;\n\n    void main () {\n        vec4 sum = vec4(0.0);\n        sum += texture2D(uTexture, vL);\n        sum += texture2D(uTexture, vR);\n        sum += texture2D(uTexture, vT);\n        sum += texture2D(uTexture, vB);\n        sum *= 0.25;\n        gl_FragColor = sum * intensity;\n    }\n");

var sunraysMaskShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision highp float;\n    precision highp sampler2D;\n\n    varying vec2 vUv;\n    uniform sampler2D uTexture;\n\n    void main () {\n        vec4 c = texture2D(uTexture, vUv);\n        float br = max(c.r, max(c.g, c.b));\n        c.a = 1.0 - min(max(br * 20.0, 0.0), 0.8);\n        gl_FragColor = c;\n    }\n");

var sunraysShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision highp float;\n    precision highp sampler2D;\n\n    varying vec2 vUv;\n    uniform sampler2D uTexture;\n    uniform float weight;\n\n    #define ITERATIONS 16\n\n    void main () {\n        float Density = 0.3;\n        float Decay = 0.95;\n        float Exposure = 0.7;\n\n        vec2 coord = vUv;\n        vec2 dir = vUv - 0.5;\n\n        dir *= 1.0 / float(ITERATIONS) * Density;\n        float illuminationDecay = 1.0;\n\n        float color = texture2D(uTexture, vUv).a;\n\n        for (int i = 0; i < ITERATIONS; i++)\n        {\n            coord -= dir;\n            float col = texture2D(uTexture, coord).a;\n            color += col * illuminationDecay * weight;\n            illuminationDecay *= Decay;\n        }\n\n        gl_FragColor = vec4(color * Exposure, 0.0, 0.0, 1.0);\n    }\n");

var splatShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision highp float;\n    precision highp sampler2D;\n\n    varying vec2 vUv;\n    uniform sampler2D uTarget;\n    uniform float aspectRatio;\n    uniform vec3 color;\n    uniform vec2 point;\n    uniform float radius;\n\n    void main () {\n        vec2 p = vUv - point.xy;\n        p.x *= aspectRatio;\n        vec3 splat = exp(-dot(p, p) / radius) * color;\n        vec3 base = texture2D(uTarget, vUv).xyz;\n        gl_FragColor = vec4(base + splat, 1.0);\n    }\n");

var advectionShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision highp float;\n    precision highp sampler2D;\n\n    varying vec2 vUv;\n    uniform sampler2D uVelocity;\n    uniform sampler2D uSource;\n    uniform vec2 texelSize;\n    uniform vec2 dyeTexelSize;\n    uniform float dt;\n    uniform float dissipation;\n\n    vec4 bilerp (sampler2D sam, vec2 uv, vec2 tsize) {\n        vec2 st = uv / tsize - 0.5;\n\n        vec2 iuv = floor(st);\n        vec2 fuv = fract(st);\n\n        vec4 a = texture2D(sam, (iuv + vec2(0.5, 0.5)) * tsize);\n        vec4 b = texture2D(sam, (iuv + vec2(1.5, 0.5)) * tsize);\n        vec4 c = texture2D(sam, (iuv + vec2(0.5, 1.5)) * tsize);\n        vec4 d = texture2D(sam, (iuv + vec2(1.5, 1.5)) * tsize);\n\n        return mix(mix(a, b, fuv.x), mix(c, d, fuv.x), fuv.y);\n    }\n\n    void main () {\n    #ifdef MANUAL_FILTERING\n        vec2 coord = vUv - dt * bilerp(uVelocity, vUv, texelSize).xy * texelSize;\n        vec4 result = bilerp(uSource, coord, dyeTexelSize);\n    #else\n        vec2 coord = vUv - dt * texture2D(uVelocity, vUv).xy * texelSize;\n        vec4 result = texture2D(uSource, coord);\n    #endif\n        float decay = 1.0 + dissipation * dt;\n        gl_FragColor = result / decay;\n    }",
    ext.supportLinearFiltering ? null : ['MANUAL_FILTERING']
);

var divergenceShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying highp vec2 vUv;\n    varying highp vec2 vL;\n    varying highp vec2 vR;\n    varying highp vec2 vT;\n    varying highp vec2 vB;\n    uniform sampler2D uVelocity;\n\n    void main () {\n        float L = texture2D(uVelocity, vL).x;\n        float R = texture2D(uVelocity, vR).x;\n        float T = texture2D(uVelocity, vT).y;\n        float B = texture2D(uVelocity, vB).y;\n\n        vec2 C = texture2D(uVelocity, vUv).xy;\n        if (vL.x < 0.0) { L = -C.x; }\n        if (vR.x > 1.0) { R = -C.x; }\n        if (vT.y > 1.0) { T = -C.y; }\n        if (vB.y < 0.0) { B = -C.y; }\n\n        float div = 0.5 * (R - L + T - B);\n        gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n    }\n");

var curlShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying highp vec2 vUv;\n    varying highp vec2 vL;\n    varying highp vec2 vR;\n    varying highp vec2 vT;\n    varying highp vec2 vB;\n    uniform sampler2D uVelocity;\n\n    void main () {\n        float L = texture2D(uVelocity, vL).y;\n        float R = texture2D(uVelocity, vR).y;\n        float T = texture2D(uVelocity, vT).x;\n        float B = texture2D(uVelocity, vB).x;\n        float vorticity = R - L - T + B;\n        gl_FragColor = vec4(0.5 * vorticity, 0.0, 0.0, 1.0);\n    }\n");

var vorticityShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision highp float;\n    precision highp sampler2D;\n\n    varying vec2 vUv;\n    varying vec2 vL;\n    varying vec2 vR;\n    varying vec2 vT;\n    varying vec2 vB;\n    uniform sampler2D uVelocity;\n    uniform sampler2D uCurl;\n    uniform float curl;\n    uniform float dt;\n\n    void main () {\n        float L = texture2D(uCurl, vL).x;\n        float R = texture2D(uCurl, vR).x;\n        float T = texture2D(uCurl, vT).x;\n        float B = texture2D(uCurl, vB).x;\n        float C = texture2D(uCurl, vUv).x;\n\n        vec2 force = 0.5 * vec2(abs(T) - abs(B), abs(R) - abs(L));\n        force /= length(force) + 0.0001;\n        force *= curl * C;\n        force.y *= -1.0;\n\n        vec2 vel = texture2D(uVelocity, vUv).xy;\n        gl_FragColor = vec4(vel + force * dt, 0.0, 1.0);\n    }\n");

var pressureShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying highp vec2 vUv;\n    varying highp vec2 vL;\n    varying highp vec2 vR;\n    varying highp vec2 vT;\n    varying highp vec2 vB;\n    uniform sampler2D uPressure;\n    uniform sampler2D uDivergence;\n\n    void main () {\n        float L = texture2D(uPressure, vL).x;\n        float R = texture2D(uPressure, vR).x;\n        float T = texture2D(uPressure, vT).x;\n        float B = texture2D(uPressure, vB).x;\n        float C = texture2D(uPressure, vUv).x;\n        float divergence = texture2D(uDivergence, vUv).x;\n        float pressure = (L + R + B + T - divergence) * 0.25;\n        gl_FragColor = vec4(pressure, 0.0, 0.0, 1.0);\n    }\n");

var gradientSubtractShader = compileShader(gl.FRAGMENT_SHADER, "\n    precision mediump float;\n    precision mediump sampler2D;\n\n    varying highp vec2 vUv;\n    varying highp vec2 vL;\n    varying highp vec2 vR;\n    varying highp vec2 vT;\n    varying highp vec2 vB;\n    uniform sampler2D uPressure;\n    uniform sampler2D uVelocity;\n\n    void main () {\n        float L = texture2D(uPressure, vL).x;\n        float R = texture2D(uPressure, vR).x;\n        float T = texture2D(uPressure, vT).x;\n        float B = texture2D(uPressure, vB).x;\n        vec2 velocity = texture2D(uVelocity, vUv).xy;\n        velocity.xy -= vec2(R - L, T - B);\n        gl_FragColor = vec4(velocity, 0.0, 1.0);\n    }\n");

var blit = (function () {
    gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, -1, 1, 1, 1, 1, -1]), gl.STATIC_DRAW);
    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.createBuffer());
    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 0, 2, 3]), gl.STATIC_DRAW);
    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);
    gl.enableVertexAttribArray(0);

    return function (destination) {
        gl.bindFramebuffer(gl.FRAMEBUFFER, destination);
        gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);
    }
})();

var dye;
var velocity;
var divergence;
var curl;
var pressure;
var bloom;
var bloomFramebuffers = [];
var sunrays;
var sunraysTemp;

//var ditheringTexture = createTextureAsync('LDR_LLL1_0.png');

var blurProgram            = new Program(blurVertexShader, blurShader);
var copyProgram            = new Program(baseVertexShader, copyShader);
var clearProgram           = new Program(baseVertexShader, clearShader);
var colorProgram           = new Program(baseVertexShader, colorShader);
var bloomPrefilterProgram  = new Program(baseVertexShader, bloomPrefilterShader);
var bloomBlurProgram       = new Program(baseVertexShader, bloomBlurShader);
var bloomFinalProgram      = new Program(baseVertexShader, bloomFinalShader);
var sunraysMaskProgram     = new Program(baseVertexShader, sunraysMaskShader);
var sunraysProgram         = new Program(baseVertexShader, sunraysShader);
var splatProgram           = new Program(baseVertexShader, splatShader);
var advectionProgram       = new Program(baseVertexShader, advectionShader);
var divergenceProgram      = new Program(baseVertexShader, divergenceShader);
var curlProgram            = new Program(baseVertexShader, curlShader);
var vorticityProgram       = new Program(baseVertexShader, vorticityShader);
var pressureProgram        = new Program(baseVertexShader, pressureShader);
var gradienSubtractProgram = new Program(baseVertexShader, gradientSubtractShader);

var displayMaterial = new Material(baseVertexShader, displayShaderSource);

function initFramebuffers () {
    var simRes = getResolution(config.SIM_RESOLUTION);
    var dyeRes = getResolution(config.DYE_RESOLUTION);

    var texType = ext.halfFloatTexType;
    var rgba    = ext.formatRGBA;
    var rg      = ext.formatRG;
    var r       = ext.formatR;
    var filtering = ext.supportLinearFiltering ? gl.LINEAR : gl.NEAREST;

    if (dye == null)
        { dye = createDoubleFBO(dyeRes.width, dyeRes.height, rgba.internalFormat, rgba.format, texType, filtering); }
    else
        { dye = resizeDoubleFBO(dye, dyeRes.width, dyeRes.height, rgba.internalFormat, rgba.format, texType, filtering); }

    if (velocity == null)
        { velocity = createDoubleFBO(simRes.width, simRes.height, rg.internalFormat, rg.format, texType, filtering); }
    else
        { velocity = resizeDoubleFBO(velocity, simRes.width, simRes.height, rg.internalFormat, rg.format, texType, filtering); }

    divergence = createFBO      (simRes.width, simRes.height, r.internalFormat, r.format, texType, gl.NEAREST);
    curl       = createFBO      (simRes.width, simRes.height, r.internalFormat, r.format, texType, gl.NEAREST);
    pressure   = createDoubleFBO(simRes.width, simRes.height, r.internalFormat, r.format, texType, gl.NEAREST);

    initBloomFramebuffers();
    initSunraysFramebuffers();
}

function initBloomFramebuffers () {
    var res = getResolution(config.BLOOM_RESOLUTION);

    var texType = ext.halfFloatTexType;
    var rgba = ext.formatRGBA;
    var filtering = ext.supportLinearFiltering ? gl.LINEAR : gl.NEAREST;

    bloom = createFBO(res.width, res.height, rgba.internalFormat, rgba.format, texType, filtering);

    bloomFramebuffers.length = 0;
    for (var i = 0; i < config.BLOOM_ITERATIONS; i++)
    {
        var width = res.width >> (i + 1);
        var height = res.height >> (i + 1);

        if (width < 2 || height < 2) { break; }

        var fbo = createFBO(width, height, rgba.internalFormat, rgba.format, texType, filtering);
        bloomFramebuffers.push(fbo);
    }
}

function initSunraysFramebuffers () {
    var res = getResolution(config.SUNRAYS_RESOLUTION);

    var texType = ext.halfFloatTexType;
    var r = ext.formatR;
    var filtering = ext.supportLinearFiltering ? gl.LINEAR : gl.NEAREST;

    sunrays     = createFBO(res.width, res.height, r.internalFormat, r.format, texType, filtering);
    sunraysTemp = createFBO(res.width, res.height, r.internalFormat, r.format, texType, filtering);
}

function createFBO (w, h, internalFormat, format, type, param) {
    gl.activeTexture(gl.TEXTURE0);
    var texture = gl.createTexture();
    gl.bindTexture(gl.TEXTURE_2D, texture);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, param);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, param);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
    gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, w, h, 0, format, type, null);

    var fbo = gl.createFramebuffer();
    gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);
    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);
    gl.viewport(0, 0, w, h);
    gl.clear(gl.COLOR_BUFFER_BIT);

    var texelSizeX = 1.0 / w;
    var texelSizeY = 1.0 / h;

    return {
        texture: texture,
        fbo: fbo,
        width: w,
        height: h,
        texelSizeX: texelSizeX,
        texelSizeY: texelSizeY,
        attach: function attach (id) {
            gl.activeTexture(gl.TEXTURE0 + id);
            gl.bindTexture(gl.TEXTURE_2D, texture);
            return id;
        }
    };
}

function createDoubleFBO (w, h, internalFormat, format, type, param) {
    var fbo1 = createFBO(w, h, internalFormat, format, type, param);
    var fbo2 = createFBO(w, h, internalFormat, format, type, param);

    return {
        width: w,
        height: h,
        texelSizeX: fbo1.texelSizeX,
        texelSizeY: fbo1.texelSizeY,
        get read () {
            return fbo1;
        },
        set read (value) {
            fbo1 = value;
        },
        get write () {
            return fbo2;
        },
        set write (value) {
            fbo2 = value;
        },
        swap: function swap () {
            var temp = fbo1;
            fbo1 = fbo2;
            fbo2 = temp;
        }
    }
}

function resizeFBO (target, w, h, internalFormat, format, type, param) {
    var newFBO = createFBO(w, h, internalFormat, format, type, param);
    copyProgram.bind();
    gl.uniform1i(copyProgram.uniforms.uTexture, target.attach(0));
    blit(newFBO.fbo);
    return newFBO;
}

function resizeDoubleFBO (target, w, h, internalFormat, format, type, param) {
    if (target.width == w && target.height == h)
        { return target; }
    target.read = resizeFBO(target.read, w, h, internalFormat, format, type, param);
    target.write = createFBO(w, h, internalFormat, format, type, param);
    target.width = w;
    target.height = h;
    target.texelSizeX = 1.0 / w;
    target.texelSizeY = 1.0 / h;
    return target;
}

function createTextureAsync (url) {
    var texture = gl.createTexture();
    gl.bindTexture(gl.TEXTURE_2D, texture);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);
    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, 1, 1, 0, gl.RGB, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 255]));

    var obj = {
        texture: texture,
        width: 1,
        height: 1,
        attach: function attach (id) {
            gl.activeTexture(gl.TEXTURE0 + id);
            gl.bindTexture(gl.TEXTURE_2D, texture);
            return id;
        }
    };

    var image = new Image();
    image.onload = function () {
        obj.width = image.width;
        obj.height = image.height;
        gl.bindTexture(gl.TEXTURE_2D, texture);
        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image);
    };
    image.src = url;

    return obj;
}

function updateKeywords () {
    var displayKeywords = [];
    if (config.SHADING) { displayKeywords.push("SHADING"); }
    if (config.BLOOM) { displayKeywords.push("BLOOM"); }
    if (config.SUNRAYS) { displayKeywords.push("SUNRAYS"); }
    displayMaterial.setKeywords(displayKeywords);
}

updateKeywords();
initFramebuffers();

multipleSplats(parseInt(Math.random() * 4) + 3);

var lastUpdateTime = Date.now();
var colorUpdateTimer = 0.0;
update();

function update () {
    var dt = calcDeltaTime();
    if (resizeCanvas())
        { initFramebuffers(); }
    updateColors(dt);
    applyInputs();
    if (!config.PAUSED)
        { step(dt); }
    render(null);
    requestAnimationFrame(update);
}

function calcDeltaTime () {
    var now = Date.now();
    var dt = (now - lastUpdateTime) / 1000;
    dt = Math.min(dt, 0.016666);
    lastUpdateTime = now;
    return dt;
}

function resizeCanvas () {
    var width = scaleByPixelRatio(canvas.clientWidth);
    var height = scaleByPixelRatio(canvas.clientHeight);
    if (canvas.width != width || canvas.height != height) {
        canvas.width = width;
        canvas.height = height;
        return true;
    }
    return false;
}

function updateColors (dt) {
    if (!config.COLORFUL) { return; }

    colorUpdateTimer += dt * config.COLOR_UPDATE_SPEED;
    if (colorUpdateTimer >= 1) {
        colorUpdateTimer = wrap(colorUpdateTimer, 0, 1);
        pointers.forEach(function (p) {
            p.color = generateColor();
        });
    }
}

function applyInputs () {
    if (splatStack.length > 0)
        { multipleSplats(splatStack.pop()); }

    pointers.forEach(function (p) {
        if (p.moved) {
            p.moved = false;
            splatPointer(p);
        }
    });
}

function step (dt) {
    gl.disable(gl.BLEND);
    gl.viewport(0, 0, velocity.width, velocity.height);

    curlProgram.bind();
    gl.uniform2f(curlProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);
    gl.uniform1i(curlProgram.uniforms.uVelocity, velocity.read.attach(0));
    blit(curl.fbo);

    vorticityProgram.bind();
    gl.uniform2f(vorticityProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);
    gl.uniform1i(vorticityProgram.uniforms.uVelocity, velocity.read.attach(0));
    gl.uniform1i(vorticityProgram.uniforms.uCurl, curl.attach(1));
    gl.uniform1f(vorticityProgram.uniforms.curl, config.CURL);
    gl.uniform1f(vorticityProgram.uniforms.dt, dt);
    blit(velocity.write.fbo);
    velocity.swap();

    divergenceProgram.bind();
    gl.uniform2f(divergenceProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);
    gl.uniform1i(divergenceProgram.uniforms.uVelocity, velocity.read.attach(0));
    blit(divergence.fbo);

    clearProgram.bind();
    gl.uniform1i(clearProgram.uniforms.uTexture, pressure.read.attach(0));
    gl.uniform1f(clearProgram.uniforms.value, config.PRESSURE);
    blit(pressure.write.fbo);
    pressure.swap();

    pressureProgram.bind();
    gl.uniform2f(pressureProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);
    gl.uniform1i(pressureProgram.uniforms.uDivergence, divergence.attach(0));
    for (var i = 0; i < config.PRESSURE_ITERATIONS; i++) {
        gl.uniform1i(pressureProgram.uniforms.uPressure, pressure.read.attach(1));
        blit(pressure.write.fbo);
        pressure.swap();
    }

    gradienSubtractProgram.bind();
    gl.uniform2f(gradienSubtractProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);
    gl.uniform1i(gradienSubtractProgram.uniforms.uPressure, pressure.read.attach(0));
    gl.uniform1i(gradienSubtractProgram.uniforms.uVelocity, velocity.read.attach(1));
    blit(velocity.write.fbo);
    velocity.swap();

    advectionProgram.bind();
    gl.uniform2f(advectionProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);
    if (!ext.supportLinearFiltering)
        { gl.uniform2f(advectionProgram.uniforms.dyeTexelSize, velocity.texelSizeX, velocity.texelSizeY); }
    var velocityId = velocity.read.attach(0);
    gl.uniform1i(advectionProgram.uniforms.uVelocity, velocityId);
    gl.uniform1i(advectionProgram.uniforms.uSource, velocityId);
    gl.uniform1f(advectionProgram.uniforms.dt, dt);
    gl.uniform1f(advectionProgram.uniforms.dissipation, config.VELOCITY_DISSIPATION);
    blit(velocity.write.fbo);
    velocity.swap();

    gl.viewport(0, 0, dye.width, dye.height);

    if (!ext.supportLinearFiltering)
        { gl.uniform2f(advectionProgram.uniforms.dyeTexelSize, dye.texelSizeX, dye.texelSizeY); }
    gl.uniform1i(advectionProgram.uniforms.uVelocity, velocity.read.attach(0));
    gl.uniform1i(advectionProgram.uniforms.uSource, dye.read.attach(1));
    gl.uniform1f(advectionProgram.uniforms.dissipation, config.DENSITY_DISSIPATION);
    blit(dye.write.fbo);
    dye.swap();
}

function render (target) {
    if (config.BLOOM)
        { applyBloom(dye.read, bloom); }
    if (config.SUNRAYS) {
        applySunrays(dye.read, dye.write, sunrays);
        blur(sunrays, sunraysTemp, 1);
    }

    if (target == null || !config.TRANSPARENT) {
        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
        gl.enable(gl.BLEND);
    }
    else {
        gl.disable(gl.BLEND);
    }

    var width = target == null ? gl.drawingBufferWidth : target.width;
    var height = target == null ? gl.drawingBufferHeight : target.height;
    gl.viewport(0, 0, width, height);

    var fbo = target == null ? null : target.fbo;
    if (!config.TRANSPARENT)
        { drawColor(fbo, normalizeColor(config.BACK_COLOR)); }
    if (target == null && config.TRANSPARENT)
    drawDisplay(fbo, width, height);
}

function drawColor (fbo, color) {
    colorProgram.bind();
    gl.uniform4f(colorProgram.uniforms.color, color.r, color.g, color.b, 1);
    blit(fbo);
}



function drawDisplay (fbo, width, height) {
    displayMaterial.bind();
    if (config.SHADING)
        { gl.uniform2f(displayMaterial.uniforms.texelSize, 1.0 / width, 1.0 / height); }
    gl.uniform1i(displayMaterial.uniforms.uTexture, dye.read.attach(0));
    if (config.BLOOM) {
        gl.uniform1i(displayMaterial.uniforms.uBloom, bloom.attach(1));
        gl.uniform1i(displayMaterial.uniforms.uDithering, ditheringTexture.attach(2));
        var scale = getTextureScale(ditheringTexture, width, height);
        gl.uniform2f(displayMaterial.uniforms.ditherScale, scale.x, scale.y);
    }
    if (config.SUNRAYS)
        { gl.uniform1i(displayMaterial.uniforms.uSunrays, sunrays.attach(3)); }
    blit(fbo);
}

function applyBloom (source, destination) {
    if (bloomFramebuffers.length < 2)
        { return; }

    var last = destination;

    gl.disable(gl.BLEND);
    bloomPrefilterProgram.bind();
    var knee = config.BLOOM_THRESHOLD * config.BLOOM_SOFT_KNEE + 0.0001;
    var curve0 = config.BLOOM_THRESHOLD - knee;
    var curve1 = knee * 2;
    var curve2 = 0.25 / knee;
    gl.uniform3f(bloomPrefilterProgram.uniforms.curve, curve0, curve1, curve2);
    gl.uniform1f(bloomPrefilterProgram.uniforms.threshold, config.BLOOM_THRESHOLD);
    gl.uniform1i(bloomPrefilterProgram.uniforms.uTexture, source.attach(0));
    gl.viewport(0, 0, last.width, last.height);
    blit(last.fbo);

    bloomBlurProgram.bind();
    for (var i = 0; i < bloomFramebuffers.length; i++) {
        var dest = bloomFramebuffers[i];
        gl.uniform2f(bloomBlurProgram.uniforms.texelSize, last.texelSizeX, last.texelSizeY);
        gl.uniform1i(bloomBlurProgram.uniforms.uTexture, last.attach(0));
        gl.viewport(0, 0, dest.width, dest.height);
        blit(dest.fbo);
        last = dest;
    }

    gl.blendFunc(gl.ONE, gl.ONE);
    gl.enable(gl.BLEND);

    for (var i$1 = bloomFramebuffers.length - 2; i$1 >= 0; i$1--) {
        var baseTex = bloomFramebuffers[i$1];
        gl.uniform2f(bloomBlurProgram.uniforms.texelSize, last.texelSizeX, last.texelSizeY);
        gl.uniform1i(bloomBlurProgram.uniforms.uTexture, last.attach(0));
        gl.viewport(0, 0, baseTex.width, baseTex.height);
        blit(baseTex.fbo);
        last = baseTex;
    }

    gl.disable(gl.BLEND);
    bloomFinalProgram.bind();
    gl.uniform2f(bloomFinalProgram.uniforms.texelSize, last.texelSizeX, last.texelSizeY);
    gl.uniform1i(bloomFinalProgram.uniforms.uTexture, last.attach(0));
    gl.uniform1f(bloomFinalProgram.uniforms.intensity, config.BLOOM_INTENSITY);
    gl.viewport(0, 0, destination.width, destination.height);
    blit(destination.fbo);
}

function applySunrays (source, mask, destination) {
    gl.disable(gl.BLEND);
    sunraysMaskProgram.bind();
    gl.uniform1i(sunraysMaskProgram.uniforms.uTexture, source.attach(0));
    gl.viewport(0, 0, mask.width, mask.height);
    blit(mask.fbo);

    sunraysProgram.bind();
    gl.uniform1f(sunraysProgram.uniforms.weight, config.SUNRAYS_WEIGHT);
    gl.uniform1i(sunraysProgram.uniforms.uTexture, mask.attach(0));
    gl.viewport(0, 0, destination.width, destination.height);
    blit(destination.fbo);
}

function blur (target, temp, iterations) {
    blurProgram.bind();
    for (var i = 0; i < iterations; i++) {
        gl.uniform2f(blurProgram.uniforms.texelSize, target.texelSizeX, 0.0);
        gl.uniform1i(blurProgram.uniforms.uTexture, target.attach(0));
        blit(temp.fbo);

        gl.uniform2f(blurProgram.uniforms.texelSize, 0.0, target.texelSizeY);
        gl.uniform1i(blurProgram.uniforms.uTexture, temp.attach(0));
        blit(target.fbo);
    }
}

function splatPointer (pointer) {
    var dx = pointer.deltaX * config.SPLAT_FORCE;
    var dy = pointer.deltaY * config.SPLAT_FORCE;
    splat(pointer.texcoordX, pointer.texcoordY, dx, dy, pointer.color);
}

function multipleSplats (amount) {
    for (var i = 0; i < amount; i++) {
        var color = generateColor();
        color.r *= 10.0;
        color.g *= 10.0;
        color.b *= 10.0;
        var x = Math.random();
        var y = Math.random();
        var dx = 1000 * (Math.random() - 0.5);
        var dy = 1000 * (Math.random() - 0.5);
        splat(x, y, dx, dy, color);
    }
}

function splat (x, y, dx, dy, color) {
    gl.viewport(0, 0, velocity.width, velocity.height);
    splatProgram.bind();
    gl.uniform1i(splatProgram.uniforms.uTarget, velocity.read.attach(0));
    gl.uniform1f(splatProgram.uniforms.aspectRatio, canvas.width / canvas.height);
    gl.uniform2f(splatProgram.uniforms.point, x, y);
    gl.uniform3f(splatProgram.uniforms.color, dx, dy, 0.0);
    gl.uniform1f(splatProgram.uniforms.radius, correctRadius(config.SPLAT_RADIUS / 100.0));
    blit(velocity.write.fbo);
    velocity.swap();

    gl.viewport(0, 0, dye.width, dye.height);
    gl.uniform1i(splatProgram.uniforms.uTarget, dye.read.attach(0));
    gl.uniform3f(splatProgram.uniforms.color, color.r, color.g, color.b);
    blit(dye.write.fbo);
    dye.swap();
}

function correctRadius (radius) {
    var aspectRatio = canvas.width / canvas.height;
    if (aspectRatio > 1)
        { radius *= aspectRatio; }
    return radius;
}

canvas.addEventListener('mousedown', function (e) {
    var posX = scaleByPixelRatio(e.offsetX);
    var posY = scaleByPixelRatio(e.offsetY);
    var pointer = pointers.find(function (p) { return p.id == -1; });
    if (pointer == null)
        { pointer = new pointerPrototype(); }
    updatePointerDownData(pointer, -1, posX, posY);
});

canvas.addEventListener('mousemove', function (e) {
    var pointer = pointers[0];
    if (!pointer.down) { return; }
    var posX = scaleByPixelRatio(e.offsetX);
    var posY = scaleByPixelRatio(e.offsetY);
    updatePointerMoveData(pointer, posX, posY);
});

window.addEventListener('mouseup', function () {
    updatePointerUpData(pointers[0]);
});

canvas.addEventListener('touchstart', function (e) {
    e.preventDefault();
    var touches = e.targetTouches;
    while (touches.length >= pointers.length)
        { pointers.push(new pointerPrototype()); }
    for (var i = 0; i < touches.length; i++) {
        var posX = scaleByPixelRatio(touches[i].pageX);
        var posY = scaleByPixelRatio(touches[i].pageY);
        updatePointerDownData(pointers[i + 1], touches[i].identifier, posX, posY);
    }
});

canvas.addEventListener('touchmove', function (e) {
    e.preventDefault();
    var touches = e.targetTouches;
    for (var i = 0; i < touches.length; i++) {
        var pointer = pointers[i + 1];
        if (!pointer.down) { continue; }
        var posX = scaleByPixelRatio(touches[i].pageX);
        var posY = scaleByPixelRatio(touches[i].pageY);
        updatePointerMoveData(pointer, posX, posY);
    }
}, false);

window.addEventListener('touchend', function (e) {
    var touches = e.changedTouches;
    var loop = function ( i ) {
        var pointer = pointers.find(function (p) { return p.id == touches[i].identifier; });
        if (pointer == null) { return; }
        updatePointerUpData(pointer);
    };

    for (var i = 0; i < touches.length; i++)
    loop( i );
});

window.addEventListener('keydown', function (e) {
    if (e.code === 'KeyP')
        { config.PAUSED = !config.PAUSED; }
    if (e.key === ' ')
        { splatStack.push(parseInt(Math.random() * 20) + 5); }
});

function updatePointerDownData (pointer, id, posX, posY) {
    pointer.id = id;
    pointer.down = true;
    pointer.moved = false;
    pointer.texcoordX = posX / canvas.width;
    pointer.texcoordY = 1.0 - posY / canvas.height;
    pointer.prevTexcoordX = pointer.texcoordX;
    pointer.prevTexcoordY = pointer.texcoordY;
    pointer.deltaX = 0;
    pointer.deltaY = 0;
    pointer.color = generateColor();
}

function updatePointerMoveData (pointer, posX, posY) {
    pointer.prevTexcoordX = pointer.texcoordX;
    pointer.prevTexcoordY = pointer.texcoordY;
    pointer.texcoordX = posX / canvas.width;
    pointer.texcoordY = 1.0 - posY / canvas.height;
    pointer.deltaX = correctDeltaX(pointer.texcoordX - pointer.prevTexcoordX);
    pointer.deltaY = correctDeltaY(pointer.texcoordY - pointer.prevTexcoordY);
    pointer.moved = Math.abs(pointer.deltaX) > 0 || Math.abs(pointer.deltaY) > 0;
}

function updatePointerUpData (pointer) {
    pointer.down = true;
}

function correctDeltaX (delta) {
    var aspectRatio = canvas.width / canvas.height;
    if (aspectRatio < 1) { delta *= aspectRatio; }
    return delta;
}

function correctDeltaY (delta) {
    var aspectRatio = canvas.width / canvas.height;
    if (aspectRatio > 1) { delta /= aspectRatio; }
    return delta;
}

function generateColor () {
    var c = HSVtoRGB(Math.random(), 1.0, 1.0);
    c.r *= 0.15;
    c.g *= 0.15;
    c.b *= 0.15;
    return c;
}

function HSVtoRGB (h, s, v) {
    var r, g, b, i, f, p, q, t;
    i = Math.floor(h * 6);
    f = h * 6 - i;
    p = v * (1 - s);
    q = v * (1 - f * s);
    t = v * (1 - (1 - f) * s);

    switch (i % 6) {
        case 0: r = v, g = t, b = p; break;
        case 1: r = q, g = v, b = p; break;
        case 2: r = p, g = v, b = t; break;
        case 3: r = p, g = q, b = v; break;
        case 4: r = t, g = p, b = v; break;
        case 5: r = v, g = p, b = q; break;
    }

    return {
        r: r,
        g: g,
        b: b
    };
}

function normalizeColor (input) {
    var output = {
        r: input.r / 255,
        g: input.g / 255,
        b: input.b / 255
    };
    return output;
}

function wrap (value, min, max) {
    var range = max - min;
    if (range == 0) { return min; }
    return (value - min) % range + min;
}

function getResolution (resolution) {
    var aspectRatio = gl.drawingBufferWidth / gl.drawingBufferHeight;
    if (aspectRatio < 1)
        { aspectRatio = 1.0 / aspectRatio; }

    var min = Math.round(resolution);
    var max = Math.round(resolution * aspectRatio);

    if (gl.drawingBufferWidth > gl.drawingBufferHeight)
        { return { width: max, height: min }; }
    else
        { return { width: min, height: max }; }
}

function getTextureScale (texture, width, height) {
    return {
        x: width / texture.width,
        y: height / texture.height
    };
}

function scaleByPixelRatio (input) {
    var pixelRatio = window.devicePixelRatio || 1;
    return Math.floor(input * pixelRatio);
}

function hashCode (s) {
    if (s.length == 0) { return 0; }
    var hash = 0;
    for (var i = 0; i < s.length; i++) {
        hash = (hash << 5) - hash + s.charCodeAt(i);
        hash |= 0; // Convert to 32bit integer
    }
    return hash;
};


 //COOKIE LOGIC -> MAIN 

function getCookie(name) {
    // Split cookie string and get all individual name=value pairs in an array
    var cookieArr = document.cookie.split(";");
    
    // Loop through the array elements
    for(var i = 0; i < cookieArr.length; i++) {
        var cookiePair = cookieArr[i].split("=");
        
        /* Removing whitespace at the beginning of the cookie name
        and compare it with the given string */
        if(name == cookiePair[0].trim()) {
            // Decode the cookie value and return
            return decodeURIComponent(cookiePair[1]);
        }
    }
    
    // Return null if not found
    return null;
}
   
 //Force cookie to first section without intro
  document.cookie = "userActive = 1;";

  function checkCookie() {
    // Get cookie using our custom function
    var userActive = getCookie("userActive");
    
    if(userActive == 1) {
      
      gsap.to("#scene_1", {duration: 0, display:"contents"});
      gsap.to("#introStart", {duration: 0, display:"none"});
      cityStart();
       //Boats Start  
   
    } else {
     
     // alert("Welcome new guy, " + userActive);
  
     introStart();
     cityStart();
  
    document.cookie = "userActive = 1;";

        }
    }
    checkCookie();

//MOUSE FOLLOWER

gsap.set(".ball", {xPercent: -50, yPercent: -50});
gsap.set(".ball2", {xPercent: -50, yPercent: -50});
gsap.set(".ball3", {xPercent: -50, yPercent: -50});

var ball = document.querySelector(".ball");
var ball2 = document.querySelector(".ball2");
var ball3 = document.querySelector(".ball3");
var pos = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
var mouse = { x: pos.x, y: pos.y };
var speed = 0.1;

var xSet = gsap.quickSetter(ball, "x", "px");
var ySet = gsap.quickSetter(ball, "y", "px");

var xSet2 = gsap.quickSetter(ball2, "x", "px");
var ySet2 = gsap.quickSetter(ball2, "y", "px");

var xSet3 = gsap.quickSetter(ball3, "x", "px");
var ySet3 = gsap.quickSetter(ball3, "y", "px");



// window.addEventListener("mousemove", e => {    
//   mouse.x = e.x;
//   mouse.y = e.y;  
// });

// gsap.ticker.add(() => {
//   var dt = 1.0 - Math.pow(1.0 - speed, gsap.ticker.deltaRatio()); 
//   
//   pos.x += (mouse.x - pos.x) * dt;
//   pos.y += (mouse.y - pos.y) * dt;
//   xSet(pos.x);
//   ySet(pos.y);
// });

// special thanks to Blake Bowen for most of the code.


gsap.set(ball, { scale: 0, left:0 })
gsap.set(ball2, { scale: 0, left:0 })
gsap.set(ball3, { scale: 0, left:0 })

function mousemoveFunction(e) {   
    mouse.x = e.x;
    mouse.y = e.y;  
}

function tickerUpdate() {   
  var dt = 1.0 - Math.pow(1.0 - speed, gsap.ticker.deltaRatio()); 
  
  pos.x += (mouse.x - pos.x) * dt;
  pos.y += (mouse.y - pos.y) * dt;
  xSet(pos.x);
  ySet(pos.y);
}

function tickerUpdate2() {   
  var dt = 1.0 - Math.pow(1.0 - speed, gsap.ticker.deltaRatio()); 
  
  pos.x += (mouse.x - pos.x) * dt;
  pos.y += (mouse.y - pos.y) * dt;
  xSet2(pos.x);
  ySet2(pos.y);
}

function tickerUpdate3() {   
  var dt = 1.0 - Math.pow(1.0 - speed, gsap.ticker.deltaRatio()); 
  
  pos.x += (mouse.x - pos.x) * dt;
  pos.y += (mouse.y - pos.y) * dt;
  xSet3(pos.x);
  ySet3(pos.y);
}


//Section 1
var section1 = document.querySelector(".con");

section1.onmouseenter = function(){
    section1.addEventListener("mousemove", mousemoveFunction);
    gsap.ticker.add(tickerUpdate)
    gsap.to(ball, { scale: 1 })
}

section1.onmouseleave = function(){
    section1.removeEventListener("mousemove", mousemoveFunction);
    gsap.ticker.remove(tickerUpdate)
    gsap.to(ball, { scale: 0 })
}

//Section 2
var section2 = document.querySelector(".con2");

section2.onmouseenter = function(){
    section2.addEventListener("mousemove", mousemoveFunction);
    gsap.ticker.add(tickerUpdate2)
    gsap.to(ball2, { scale: 1 })
}

section2.onmouseleave = function(){
    section2.removeEventListener("mousemove", mousemoveFunction);
    gsap.ticker.remove(tickerUpdate2)
    gsap.to(ball2, { scale: 0 })
}

//Section 3
var section3 = document.querySelector(".con3");

section3.onmouseenter = function(){
    section3.addEventListener("mousemove", mousemoveFunction);
    gsap.ticker.add(tickerUpdate3)
    gsap.to(ball3, { scale: 1 })
}

section3.onmouseleave = function(){
    section3.removeEventListener("mousemove", mousemoveFunction);
    gsap.ticker.remove(tickerUpdate3)
    gsap.to(ball3, { scale: 0 })
}

//Section 4
var section4 = document.querySelector(".con4");

    section4.onmouseenter = function(){
    section4.addEventListener("mousemove", mousemoveFunction);
    gsap.ticker.add(tickerUpdate)
    gsap.to(ball, { scale: 1 })
}

section4.onmouseleave = function(){
    section4.removeEventListener("mousemove", mousemoveFunction);
    gsap.ticker.remove(tickerUpdate)
    gsap.to(ball, { scale: 0 })
}





  
}); //end DOM Loaded

</script>

    
<style>

.special-divider {
    margin: 0px auto;
    margin-bottom: 65px;
}

.navbar-wrapper {
 background-color: transparent;
}

.navbar-placeholder {
    z-index: 999;
    background-color: #f5f6fa;
}



/* start scroll portfolio*/

 

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

::-moz-selection {
  background: #87cd33;
  color: white;
}

::selection {
  background: #87cd33;
  color: white;
}

body {
  overflow: hidden;
}


.demo-wrapper h1 {
    font-size: 5rem;
    font-family: 'Nexa Bold';
    color: #334258;
}

.demo-wrapper h2 { font-size: 2rem }

.demo-wrapper img {
  width: 100%;
  height: auto;
  background: #f0f0f0;
}

.demo-wrapper ul {
  padding-left: 1rem;
  list-style: none;
}

.demo-wrapper li {
  flex-shrink: 0;
  width: clamp(500px, 60vw, 800px);
  padding-right: 1rem;
}

.demo-wrapper header {

  /*height: 36vh*/

}

.demo-wrapper footer {height: 20vh}




.df {display: flex}
.aic {align-items: center}
.jcc {justify-content: center}

.loader {
  position: absolute;
  top: 0;
  left: 0;
 
  background: black;
  color: white;
}

.demo-wrapper {
  overflow-x: hidden;
}

.wrapper {
  display: flex;
}

.demo-gallery:not(.last) {
  padding-bottom: 1rem;
}

.demo-text .text {
    font-size: clamp(8rem, 13vw, 12rem);
    line-height: 1;
    font-weight: 900;
    margin-bottom: 35px;
    color: #334258;
}
  /* end scroll portfolio*/



.section.has-pseudo-lines:before {
    z-index: 9;
    opacity: 0.8;
}

.svg-elem-12, .svg-elem-17, .svg-elem-18 {
   opacity: 0;
  }

#msg_text6{
  max-width: 500px;
}
  

  #msg_text {
    opacity: 0;
    color: #8e9baf !important;
  }
  #msg_text3 {
    opacity: 0;
    color: #8e9baf !important;
    font-size:15px;
  }

  #responseText{
    opacity: 0;
  }



@keyframes rotate {
  0% {
    transform: rotateY(0) rotateZ(-180deg);
  }
  100% {
    transform: rotateY(360deg) rotateZ(180deg);
  }
}

#web-app-dinamiche.box-title a:hover {
    color:red;
}

.teammate{
  opacity: 1;
}



strong {
  color:orange;
}

.highlight {
  color:red;
  font-family:serif;
}

.code {
  font-family:Courier;
  color:rgb(221,202,126);
}


#demo{
  position:relative;
}

.section-title-wrapper {
    position: relative;
    margin-bottom: 45px;
}




span {
  display:inline-block;
}

.droplet{
  position:absolute;
  top:-6%;
  height:40px;
  width:1px;
  background-color:white;
}

#my_text {
  padding: 80px !important;
  font-weight: 100;
  font-size: 14px;
 
    }

.svg-elem-35 {display: none;}
.svg-elem-37 {display: none;}
.svg-elem-38 {display: none;}

/*Boats */
.svg-elem-36 {z-index: 9999 !important; display: none; opacity: 0;}

.svg-elem-39 {z-index: 9999 !important; display: none; opacity: 0;}

.svg-elem-42 {z-index: 9999 !important; display: none; opacity: 0;}


.svg-elem-44 {z-index: 1 !important;}

#Layer_1 {
    cursor: url("img/brush2.svg") 25 25, auto;
    background-color: transparent !important;
}

#flag1 {
    cursor: url("img/wizard2.png") 25 25, auto;
}

.svg-elem-36, .svg-elem-39, .svg-elem-42  {cursor: crosshair;}

#flag1 {
    width: 4%;
    height: 5%;
    left: 40.2%;
    top: 11.95%;
    position: absolute;
    opacity: 0;
    z-index: 1;
}



.hero .hero-foot.is-pulled {
    margin-top: 35px !important;
}

 .hero .hero-foot.is-pulled {
    margin-top: 0px;
}

@media screen and (min-width: 769px), print{
.hero-body {
    padding: 0rem 0rem;
}
}
  .navbar-wrapper.navbar-faded {
    background: #f5f5f5;
    -webkit-box-shadow: 0 0 8px 0 rgba(0,0,0,.12);
    box-shadow: 0 0 8px 0 rgba(0,0,0,.12);
}

 body {
      color: #4a4a4a;
      font-size: 1.1em;
      font-weight: 400;
      line-height: 1.5;
  }
  
  .navbar-wrapper.is-transparent .navbar-item.is-slide, .navbar-wrapper.is-transparent .navbar-link.is-slide {
      border-bottom: 0px solid transparent !important;
  }
  
  .navbar>.container .navbar-menu, .container>.navbar .navbar-menu {
      margin-right: -0.75rem;
      margin-left: 30px;
  }
  #navbar_main{
      display:none;
  }
  #footer_ld{
      display:none;
  }
  #content{
      display:none;
  }
  .footer-light-medium .footer-body .small-footer-logo {
      height: 20px;
  }

  @media only screen and (max-width: 767px){
  .hero .hero-foot.is-pulled {
      margin-top: -65px;
      display: none;
    }

    #flag1{
      display:none;
    }
    .column.is-4 {
    -webkit-box-flex: 0;
    -ms-flex: none;
    flex: none;
    width: 100% !important;
}

   }

/* ----------- iPad 1, 2, Mini and Air ----------- */

/* Portrait and Landscape */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (-webkit-min-device-pixel-ratio: 1) {

    #flag1{display:none;}

}
  
  #wufoo-zo4iemr0h2fs0z {
      margin: 65px 14px 0 14px !important;
  }
  
  .column.is-4, .column.is-4-tablet {
      -webkit-box-flex: 0;
      -ms-flex: none;
      flex: none;
      width: 47.33333337% !important;
  }
  

  .current{
       color:#8c8cf9;
  }
  
  .color-red {
      color: #8c8cf9 !important;
  }

  .section.has-pseudo-lines:after {
    height: 0px;
    width: 0px;
    background: #8c8cf9;
}

.section .container {
    z-index: 0;
}

  #svg_container{
    margin-top: 15px;
    opacity: 0;
    
}


img#msg_text6 {
    max-width: 500px !important;
}


#header-img-overlay{
  position: absolute;
  width: 100%;
  height: 100vh;
  margin: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  background-color: #fff;
  z-index: 31;
}

.overlay-loader {
  width: 200px;
  height: 36px;
  margin: auto;
  position: relative;
  background-image: url(img/ldata-logo.svg);
  background-repeat: no-repeat;
  z-index: 32;
}

.navbar-wrapper.navbar-faded {
    background: #f5f5f5 !important;
    -webkit-box-shadow: 0 0 8px 0 rgba(0,0,0,.12);
    box-shadow: 0 0 8px 0 rgba(0,0,0,.12);
}

.hero-body {
    position: relative;
    background-size: cover !important;
    background-repeat: no-repeat !important;
    z-index: 2;
}

.hero .hero-foot.is-pulled {
    margin-top: 0px;
    /*height: 0px;*/
}
/*
div#secondSection {
    background-color: #f5f6fa;
    margin-top: -25px;
}*/

#scene_1 {

display: none;

}

/*
.main-menu a {
  cursor: url("site/assets/img/brush2.svg") 25 25, auto;
}*/
.wrapper_menu {
	width: 100%;
	margin: 0 auto;
  opacity: 0;
}

.mynav {
	position: relative;
	height: 10rem;
	z-index: 10;
  float: right;
}
  
 	.wrapper_menu {
		height: 100%;
		display: flex;
		align-items: left;
    background-color: #ffffff;
	}

.column.is-4, .column.is-4-tablet {
    -webkit-box-flex: 0;
    -ms-flex: none;
    flex: none;
    width: 26.33333337%;
}



.rect {
  fill: #8c8cf9;
  visibility: hidden;
  cursor: crosshair;
  margin: 8px;
}
.bowedRect {
  fill: none;
  visibility: hidden;
}

.vbox{
  display: flex;
  flex-direction: column;
}

.hbox{
  display: flex;
  flex-direction: row;
}

.bow, #box {
  visibility: hidden;
}




#map-widget{
 width: 190px;
 height: 65px;
 border-left: 3px solid #ffcc00;
 margin-left: 25px !important;
 padding-left: 8px !important;
 text-align:left;
 opacity: 0;
 
}

.msg_text2 {
 border: 3px solid #ccc !important;
}

.fa, .fas {
    font-weight: 600;
    color: #8c8cf9 !important;
    cursor: pointer;
}

#widget_img {
  opacity: 0;
  border-radius: 4px;
    -webkit-box-shadow: 0 3px 10px 4px rgba(0,0,0,.04);
    box-shadow: 0 3px 10px 4pxrgba(0,0,0,.04); 
}

#smartLinkContainer {
    /* text-align: left !important; */
    float: left;
   opacity: 0;
}

#canvas3 {
    left: 0;
    top: -2px;
    width: 100%;
    height: 110%;
    position: absolute;
    border-top: #fff;
    border-bottom: transparent;
    border-top-width: 2px;
    border-top-style: solid;
    border-bottom-style: solid;
    border-bottom-width: 2px;
    opacity: 0.8;
    z-index: 1;
}

.contact-toggler .tabbed-links li.is-active {
    color: #98a9c2;
    font-weight: 500;
    border-top: 2px solid #8c8cf9;
}
.contact-toggler .contact-blocks .contact-block .contact-info span:first-child {
    font-weight: 500;
    color: #d5e2f6;
}

ul#tabbed {
    max-width: 226px;
}




.myblue {
 color: #0053ce;
}

.myblack {
  color: #000000;
}





.hide-text {
  display: block;
  text-indent: 100%;
  white-space: nowrap;
  overflow: hidden;
}

.hidden {
  display: none !important;
}

.spin:before {
  -moz-animation: spin 3s linear 0s infinite;
  -webkit-animation: spin 3s linear 0s infinite;
  animation: spin 3s linear 0s infinite;
}

@-moz-keyframes spin {
  from {
    -moz-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  to {
    -moz-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
@-webkit-keyframes spin {
  from {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
@keyframes spin {
  from {
    -moz-transform: rotate(0deg);
    -ms-transform: rotate(0deg);
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  to {
    -moz-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}




*, *:before, *:after {
  box-sizing: inherit;
}


.browser {
  display: inline-block;
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  margin: 0 auto;
  background: #334258;
  max-width: 550px;
  max-height: 300px;
  width: 80px;
  height: 80px;
  overflow: hidden;
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px;
  border-radius: 5px;
  -moz-box-shadow: 0 2px 5px rgba(34, 34, 34, 0.5);
  -webkit-box-shadow: 0 2px 5px rgba(34, 34, 34, 0.5);
  box-shadow: 0 2px 5px rgba(34, 34, 34, 0.5);
}
.browser .icon {
  display: table;
  width: 100%;
  height: 100%;
  text-align: center;
  font-size: 50px;
  color: #fff;
}
.browser .icon span {
  display: table-cell;
  vertical-align: middle;
  color: #fff;
}
.browser .header, .browser .body {
  padding: 0.5em 1em;
}
.browser .header {
  background: #8c8cf9;
  color: #fff;
}
.browser .header .right {
  float: right;
}
.browser .tablet {
  text-align: center;
  color: #fff;
  background: #8c8cf9;
  margin: 10px 10px 0;
  height: 75%;
  position: relative;
}
.browser .tablet span {
  position: absolute;
  bottom: -38px;
  left: 0;
  right: 0;
  text-align: center;
}
.browser .phone {
  background: #8c8cf9;
  margin: 10px 0;
  height: 80%;
}

.aboutAni {
  max-width: 250px;
  width: 100%;
  height: 300px;
  position: absolute;
  margin: auto;
  top: 50%;
  left: 0;
  right: 0;
  overflow: hidden;
  background: #334258;
  z-index: 2;
  -moz-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  -webkit-transform: translateY(-50%);
  transform: translateY(-50%);
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px;
  border-radius: 5px;
  -moz-box-shadow: 0 2px 5px rgba(34, 34, 34, 0.5);
  -webkit-box-shadow: 0 2px 5px rgba(34, 34, 34, 0.5);
  box-shadow: 0 2px 5px rgba(34, 34, 34, 0.5);
}

.design .head {
  margin-bottom: 1em;
  width: 100%;
  height: 100px;
  background: #8c8cf9;
}
.design .box-contain {
  margin: 0 auto;
  width: 245px;
  text-align: center;
}
.design .box {
  display: inline-block;
  margin: 5px 5px 5px;
  width: 20%;
  height: 50px;
  background: #8c8cf9;
}
.design .box-large {
  width: 70%;
  height: 60px;
}

.develop {
  height: 100%;
  background: #8c8cf9;
}
.develop .sidebar {
  width: 30%;
  height: 100%;
  float: left;
  background: #8c8cf9;
}
.develop .codebar {
  width: 70%;
  height: 100%;
  padding: 1em;
  float: right;
}
.develop .line {
  margin-bottom: 15px;
  width: 100%;
  height: 7px;
  background: #fff;
}

.heart {
  text-align: center;
  height: 100%;
  font-size:75px;
  color: #fff;
}
.heart span {
  display: inherit;
  position: relative;
  top: 50%;
  color: #8710ff;
  -moz-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  -webkit-transform: translateY(-50%);
  transform: translateY(-50%);
}

.more {
  position: relative;
  top: 85%;
  -moz-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  -webkit-transform: translateY(-50%);
  transform: translateY(-50%);
  color: #fff;
  font-weight: bold;
  text-transform: uppercase;
  white-space: nowrap;
  text-align: center;
 
}
.more span {
  position: relative;
 
  margin-right: 5px;
 
  color: #fff;
  vertical-align: middle;
}

.load {
  z-index: 100;
  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  margin: auto;
  max-width: 500px;
  color: #fff;
  text-align: center;
  -moz-transform-style: preserve-3d;
  -webkit-transform-style: preserve-3d;
  transform-style: preserve-3d;
  -moz-transform: translateY(-50%);
  -ms-transform: translateY(-50%);
  -webkit-transform: translateY(-50%);
  transform: translateY(-50%);
}
.load .quote {
  margin-top: 1em;
  font-size: 23px;
  position: absolute;
  font-weight: lighter;
  color: #fff;
  z-index: 1001;
}

/*.text {
  position: absolute;
  top: 50%;
  bottom: 0;
  margin-top: -150px;
  width: 100%;
  color: #334258;
  text-align: center;
  text-transform: uppercase;
  font-weight: bold;
}*/

.aboutText {
  margin-top: -200px;
}
.aboutText div {
  display: inline-block;
}

div#secondSection {
    background-color: #f5f6fa;
}
.hero .navbar {
    background: none;
    background-color: transparent;
}
body {
    color: #4a4a4a;
    font-size: 1.1em;
    font-weight: 400;
    line-height: 1.5;
    background-color: #f5f6fa;
}
.button.is-rounded {
    border-radius: 9px;
    padding-left: calc(1em + 0.25em);
    padding-right: calc(1em + 0.25em);
}

.section.has-pseudo-lines:before {
    height: 0px;
}

.has-background-image.is-contain {
    background-size: contain;
    background-repeat: repeat;
    background-color: #f5f6fa;
    margin: auto;
}

.container2 {
      background-color: #f5f6fa;
}

.footer-light-medium {
    padding-bottom: 0 !important;
    padding-top: 4rem !important;
    background: #f5f6fa;
}
div#trust {
    margin-top: 7rem;
    margin-bottom: 2.5rem;
}
a:hover {
    color: #334258;
}
.column.is-5, .column.is-5-tablet {
    -webkit-box-flex: 0;
    -ms-flex: none;
    flex: none;
    width: 41.66666674%;
    margin: auto;
}
.ball {
  width: 15px;
  height: 15px;
  position: fixed;
  top: 0;
  left: -100px;
  border: 3px solid #8c8cf9;
  background-color: #8c8cf9;
  border-radius: 50%;
  z-index: 991;
  will-change: transform;
  pointer-events: none;
}
.ball2 {
  width: 100px;
  height: 100px;
  position: fixed;
  line-height: 86px;
  text-align: center;
  top: 0;
  left:-100px;
  border: 9px solid #8c8cf9;
  border-radius: 50%;
  z-index: 9999;
  will-change: transform;
  pointer-events: none;
  font-weight: bold;
  font-size: 12px;
  color: #d789d7;
}

.ball3 {
  width: 100px;
  height: 100px;
  position: fixed;
  line-height: 86px;
  text-align: center;
  top: 0;
  left:-100px;
  border: 9px solid #8c8cf9;
  border-radius: 50%;
  z-index: 9999;
  will-change: transform;
  pointer-events: none;
  font-weight: bold;
  font-size: 12px;
  color: #d789d7;
}
.con{}
.con2{}

 </style>


 </head>

<body class="is-theme-core">

<div id="header-img-overlay">
			<div class="overlay-loader"></div>
</div>

<span class="ball"></span>
<span class="ball2">COLORA</span>
<span class="ball3">SCROLL</span>

<canvas id="canvas3" class="con2" width="100%" height="100%"></canvas>


<nav class="navbar navbar-wrapper navbar-default navbar-fade is-transparent">
          <div class="container">
            
              <!-- Brand -->
              <div class="navbar-brand">
                  <a class="navbar-item" href="https://webstack.livedata.it">
                      <img class="switcher-logo" src="img/ldata-logo.svg" alt="Livedata">
                  </a>
      
                  <!-- Sidebar Trigger -->
      
                  <!-- Responsive toggle -->
                  <div class="custom-burger" data-target="">
                      <a id="" class="responsive-btn" href="javascript:void(0);">
                          <span class="menu-toggle">
                              <span class="icon-box-toggle">
                                  <span class="rotate">
                                      <i class="icon-line-top"></i>
                                      <i class="icon-line-center"></i>
                                      <i class="icon-line-bottom"></i>
                                  </span>
                              </span>
                          </span>
                      </a>
                  </div>
                  <!-- /Responsive toggle -->
              </div>
      
              <!-- Navbar menu -->
              <div class="navbar-menu">
                  <!-- Navbar Start -->
                  <div class="navbar-start">                  
      
                 
                    

                     
                  </div>
      
                  <!-- Navbar end -->
                  <div class="navbar-end">
                      <!-- Signup button -->
                      <div  id="navbar" class="navbar-item is-button">
                          <a id="#signup-btn" href="https://webstack.livedata.it/login/"
                              class="button button-cta is-bold is-rounded btn-align primary-btn raised scroll-link">
                              Scrivici
                          </a>
                      </div>
                  </div>
                  
              </div>
          </div>
      </nav> 


      

      <div id="introStart">

 <div class="load">
 
  <div class="quote"></div>
 </div>

<div class="browser-wrap browser-height">

  <div class="text aboutText">
    <div class="text-design">Passione per Design</div>
    <div class="text-develop">e Sviluppo Web</div>
  </div>

  <div class="aboutAni">
    <div class="design">
      <div class="head"></div>
      <div class="box-contain">

      
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box"></div>
        <div class="box box-large"> </div>
      </div>
    </div>
    <div class="develop">
      <div class="sidebar"></div>
      <div class="codebar">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <br>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <br>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
      </div>
    </div>
  </div>

  <div class="text">
    <div class="text-screen">Pensiamo in diverse dimensioni.</div>
    <div class="text-web">Amiamo creare esperienze personalizzate.</div>
  </div>

  <div class="browser">
  
    <div class="icon">
    <i class="fab fa-html5"></i>
    </div>

    <div class="header">
      <span class="back ion-20 ion-arrow-left-b"></span>
      <span class="right">
          <span class="ion-record"></span>
      <span class="ion-record"></span>
      <span class="ion-record"></span>
      </span>
    </div>
    <div class="body">
      <div class="heart">
      
      <i class="fab fa-js-square"></i>
      </div>
      
      <div class="more"><span class="spin ion-30 ion-load-c"></span> Inizializzazione</div>
    </div>

    <div class="tablet"><span class="ion-30 ion-ios-circle-filled"></span></div>
    <div class="phone"></div>
  </div>
</div>


</div> <!-- end introStart -->

<!-- SCENE 1 -->
<div id="scene_1">

<div id="firstSection" class="con hero product-hero is-app-grey is-relative">
  
<div style="margin-top:130px;" class="hero-body">


<div  id="cityContainer" class="container">

 <div class="columns is-vcentered">

  <div class="column is-8 is-offset-2 is-hero-caption is-centered">

<!-- SVG Container Hero Mockup -->
 <div id="svg_container" class="people-mockup-3">



     <div id="flag1">

                              <svg width="120" height="70" xmlns="http://www.w3.org/2000/svg">
  
                                <defs>
                                  <clipPath id="flagMask">
                                    <path id="mask" style="fill:#000;stroke:none;stroke-width:1.32292;stroke-linecap:round;stroke-linejoin:round;stroke-dashoffset:40;stop-color:#000" d="M0-25h55v70H0z" transform="translate(0 25)"/>
                                  </clipPath>
                                </defs>
                              
                                <g clip-path="url(#flagMask)">
                                  <path class="flag" style="fill:#8c8cf9;stroke-width:1.32292;stroke-linecap:round;stroke-linejoin:round;stroke-dashoffset:40;stop-color:#000" d="m 0,0 v 44.224536 c 13.060474,0 20.536739,5.888965 32.611869,5.751247 6.336323,-0.07219 14.552485,-5.751247 22.919247,-5.751247 13.060474,0 20.536739,5.888965 32.611869,5.751247 6.336323,-0.07219 14.552485,-5.751247 22.919245,-5.751247 V 0 C 94.389569,0 89.807141,8.5695618 77.516329,5.8596433 72.612487,4.7790078 61.920971,0 55.531116,0 38.858453,0 34.276026,8.5695618 21.985213,5.8596433 17.081371,4.7790078 6.3898544,0 0,0 Z"/>
                                
                                
                                             
                       <g>
                        <svg> 
                          <image style="opacity:0.4; filter: invert(100%) sepia(100%) saturate(0%) hue-rotate(288deg) brightness(102%) contrast(102%);" x="18" y="12.5" width="24" height="24" xlink:href="img/ldata-logo-icon.svg" />
                        </svg>

                       </g>
                                  
                                </g>
                                
                              </svg>
            </div>


    <!-- Audio top info/controls -->

                      </div>
  
    

    <!--City -->

    <svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" version="1.1" id="Layer_1" x="0" y="0" viewBox="0 0 750 391" xml:space="preserve" sodipodi:docname="city-hero2.svg" inkscape:version="1.0.2-2 (e86c870879, 2021-01-15)"><metadata id="metadata96"><rdf:rdf><cc:work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type><dc:title></dc:title></cc:work></rdf:rdf></metadata><defs id="defs94"></defs><sodipodi:namedview pagecolor="#ffffff" bordercolor="#666666" borderopacity="1" objecttolerance="10" gridtolerance="10" guidetolerance="10" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:window-width="1920" inkscape:window-height="1017" id="namedview92" showgrid="false" inkscape:zoom="2.0892648" inkscape:cx="392.85042" inkscape:cy="252.36222" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" inkscape:current-layer="Layer_1"></sodipodi:namedview><style id="style2">text{font: bold 36px Verdana, Helvetica, Arial, sans-serif;}.st1{stroke:#78909c;stroke-miterlimit:10}.st5{fill:#78909c}.st6,.st7,.st8{stroke:#78909c;stroke-miterlimit:10}.st6{stroke-linecap:round;stroke-linejoin:round}.st7,.st8{fill:none}.st8{stroke-linecap:round;stroke-linejoin:round}</style>
    
 <g id="OBJECTS"> 

 <foreignObject x="0" y="0" width="100%" height="86%">

    <div id="vcontent">

   <canvas id="canvas" width="100%" height="50%"></canvas>
    <canvas id="canvas2" width="100%" height="50%"></canvas>


    </div>

 </foreignObject>


   <path d="M547.9 134.9c0-.4.1-.8.1-1.2 0-6-4.8-10.8-10.8-10.8-1.4 0-2.7.3-3.9.8-1.4-8.1-8.3-14.2-16.8-14.2-8.2 0-15 5.8-16.7 13.5h-.2c-4.5 0-8.1 3.6-8.1 8.1 0 1.4.4 2.7 1 3.9h55.4v-.1zm193.2 66.3c0-.4.1-.8.1-1.2 0-6-4.8-10.8-10.8-10.8-1.4 0-2.7.3-3.9.8-1.4-8.1-8.3-14.2-16.8-14.2-8.2 0-15 5.8-16.7 13.5h-.2c-4.5 0-8.1 3.6-8.1 8.1 0 1.4.4 2.7 1 3.9l55.4-.1z" fill="#fff" style="stroke: rgb(120, 144, 156); stroke-opacity: 1;" stroke-miterlimit="10" stroke-width=".676" id="path4" class="svg-elem-1"></path>





    <path style="fill: rgb(255, 255, 255);" class="st8 svg-elem-45" d="M73.4 321.2v14.4" id="path84"></path>
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-46" d="M365.2 324.6c0 5.4-3.3 5.8-7.4 5.8s-7.4-.4-7.4-5.8 6.6-13.8 7.4-13.8c0 0 7.4 8.4 7.4 13.8z" id="path86"></path>
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-44" d="M59.5 335.6v-.3c0-1.7-1.4-3.2-3.2-3.2-.3 0-.7.1-1 .1v-.1c0-3.5-2.8-6.3-6.3-6.3-3.1 0-5.7 2.3-6.2 5.2-1.4.4-2.4 1.7-2.4 3.2 0 .5.1.9.3 1.3l18.8.1zm114.3 0v-.3c0-1.7-1.4-3.2-3.2-3.2-.3 0-.7.1-1 .1v-.1c0-3.5-2.8-6.3-6.3-6.3-3.1 0-5.7 2.3-6.2 5.2-1.4.4-2.4 1.7-2.4 3.2 0 .5.1.9.3 1.3l18.8.1zm-93-11c0 5.4-3.3 5.8-7.4 5.8s-7.4-.4-7.4-5.8 6.6-13.8 7.4-13.8c0 0 7.4 8.4 7.4 13.8z" id="path82"></path>

    <path d="m 708.7,324.6 c 0,5.4 -3.3,5.8 -7.4,5.8 -4.1,0 -7.4,-0.4 -7.4,-5.8 0,-5.4 6.6,-13.8 7.4,-13.8 0.1,0 7.4,8.4 7.4,13.8 z" id="path964" style="stroke: rgb(120, 144, 156); stroke-opacity: 1; fill: #fff;" class="svg-elem-40 svg-elem-11"></path>

    <path d="m 687.5,335.6 v -0.3 c 0,-1.7 -1.4,-3.2 -3.2,-3.2 -0.3,0 -0.7,0.1 -1,0.1 v -0.1 c 0,-3.5 -2.8,-6.3 -6.3,-6.3 -3.1,0 -5.7,2.3 -6.2,5.2 -1.4,0.4 -2.4,1.7 -2.4,3.2 0,0.5 -0.14721,1.29762 0.3,1.3 z" id="path962" style="fill: #fff; fill-opacity: 1; stroke: rgb(120, 144, 156); stroke-opacity: 1;" class="svg-elem-41 svg-elem-11"></path>

    <path id="path" fill="none" d="M-285.768,363.221 C-255.214,363.942 108.87,365.084 181.883,364.084 256.88,364.084 316.003,366.531 354.231,366.037 393.135,365.526 505.994,364.006 555.018,364.006 642.004,364.006 872.113,366.103 867.299,365.79"/>    
    <path id="path2" fill="none" d="M-128.768,344.222 C-98.215,344.943 110.87,350.084 183.883,349.084 258.88,349.084 318.003,351.531 356.231,351.037 395.135,350.526 507.994,349.006 557.018,349.006 644.004,349.006 874.113,351.103 869.299,350.79 "/>        
    <path id="path3" fill="none" d="M-114,372 C-75,375 274.65302,371.00003 297.99902,371.00003 340.99902,371.00003 806.99902,376.00003 836.99902,374.00003"/> 
    
    
  
    
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-2" d="M460.5 244.2c-.1-9-.4-15.3-.7-15.3-.3 0-.6 6.3-.7 15.3h1.4z" id="path6" style="stroke: rgb(120, 144, 156); stroke-opacity: 1;"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-3" d="M461 237.3h-2.4c-.5 0-.9.4-.9.9v11.6h4.3v-11.6c-.1-.5-.5-.9-1-.9zm-5.1 21.4h7.8v47.9h-7.8z" id="path8" style="stroke: rgb(120, 144, 156); stroke-opacity: 1;"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-4" d="M463.3 246.2h-7c-1.2 0-2.3 1-2.3 2.3v8c0 1.2 1 2.3 2.3 2.3h7c1.2 0 2.3-1 2.3-2.3v-8c0-1.3-1-2.3-2.3-2.3zm42.4 31.9c-.2-9-.6-15.3-1.2-15.3-.5 0-1 6.3-1.2 15.3h2.4z" id="path10" style="fill: #fff; stroke: rgb(120, 144, 156); stroke-opacity: 1;"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-5" d="M528 293c-2.3-10.9-11.9-19-23.5-19-11.5 0-21.2 8.1-23.5 19h47z" id="path12"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-6" d="M461.9 290.2h85.3v11.2h-85.3zM447 301.4h115.1v6.7H447zm0 6.7h115.1v27.7H447z" id="path14"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-7" d="M453.5 313h102.1v22.8H453.5z" id="path16"></path>
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-8" d="M473.6 294.8h7v41h-7zm-14 30.2v-7.9c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v7.9h3.6zm-3.7 3.2h3.7v5.7h-3.7zm9.7-3.2v-7.9c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v7.9h3.6zm-3.7 3.2h3.7v5.7h-3.7zm9.6-3.2v-7.9c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v7.9h3.6zm-3.7 3.2h3.7v5.7h-3.7zm73.4-3.2v-7.9c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v7.9h3.6zm-3.7 3.2h3.7v5.7h-3.7zm9.7-3.2v-7.9c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v7.9h3.6zm-3.7 3.2h3.7v5.7h-3.7zm9.7-3.2v-7.9c0-1-.8-1.8-1.8-1.8s-1.8.8-1.8 1.8v7.9h3.6zm-3.7 3.2h3.7v5.7h-3.7zm-66.3-11.1v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1.1 0-1.9.8-1.9 1.8zm6.5 0v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1 0-1.9.8-1.9 1.8zm6.6 0v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1.1 0-1.9.8-1.9 1.8zm6.5 0v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1 0-1.9.8-1.9 1.8zm6.6 0v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1.1 0-1.9.8-1.9 1.8zm6.5 0v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1 0-1.9.8-1.9 1.8zm6.5 0v18.7h3.8v-18.7c0-1-.9-1.8-1.9-1.8-1 0-1.9.8-1.9 1.8zm6.1-22.3h7v41h-7z" id="path18"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-9" d="M0 335.6h750v4.5H0z" id="path20"></path>
    
    <path d="M127.8 90.3c.1-.5.1-1 .1-1.5 0-7.6-6.1-13.7-13.7-13.7-1.8 0-3.4.3-5 1-1.7-10.2-10.6-18-21.3-18-10.4 0-19.1 7.3-21.2 17.1h-.3c-5.7 0-10.3 4.6-10.3 10.3 0 1.8.5 3.5 1.3 4.9h70.4v-.1z" fill="#fff" stroke="#78909c" stroke-width=".857" stroke-miterlimit="10" id="path22" class="svg-elem-10"></path>
    
    <path d="M304.6 134.9c0-.3.1-.6.1-.9 0-4.7-3.8-8.5-8.5-8.5-1.1 0-2.1.2-3.1.6-1.1-6.3-6.5-11.2-13.2-11.2-6.4 0-11.8 4.5-13.1 10.6h-.2c-3.5 0-6.3 2.8-6.3 6.3 0 1.1.3 2.1.8 3l43.5.1h0z" fill="#fff" stroke="#78909c" stroke-width=".53" stroke-miterlimit="10" id="path24" class="svg-elem-11"></path>
  
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-13" d="M323.4 90.4l-1.6-58.9-3.2-1v61.4h6.1z" id="path28"></path>
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-14" d="M318.6 91.9v243.7h24.9V114.1l-18.8-22.2z" id="path30"></path>
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-15" d="M297.9 95.9h20.8v26.3h-20.8zm-7.6 26.3h28.4v25.3h-28.4zm3 25.3h25.3v188.1h-25.3zm-10.1 0h10.1v188.1h-10.1z" id="path32"></path>
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-16" d="M295.9 150.4h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.3h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4zm-17 10.2h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.7 0h2.4v4.6h-2.4zm5.6 0h2.4v4.6h-2.4z" id="path34"></path>
   
    <path class="st5 svg-elem-17" d="M343.5 265.1v-1.5l-17.4-18.7 17.4-18.8v-1.4l-18.8 20.2zm0 52.3v-1.5l-17.4-18.7 17.4-18.7V277l-18.8 20.2zm0-104.7v-1.5l-17.4-18.7 17.4-18.7v-1.5l-18.8 20.2zm0-52.3v-1.5l-17.4-18.7 17.4-18.7V120l-18.8 20.2z" id="path36"></path>
   
    <path class="st5 svg-elem-18" d="M343.5 217.1l-22.9-24.6 22.9-24.6v-1.4l-24.3 26 24.3 26.1zm0 104.7l-22.9-24.6 22.9-24.6v-1.5l-24.3 26.1 24.3 26.1zm0-52.3l-22.9-24.6 22.9-24.6v-1.5l-24.3 26.1 24.3 26zm0-104.7l-22.9-24.6 22.9-24.6v-1.5l-24.3 26.1 24.3 26.1z" id="path38"></path>
    
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-19" d="M371.3 62.1h66.8v273.6h-66.8z" id="path40"></path>
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-20" d="M379.2 69.9h39v265.7h-39zm44.2-22.8l-52.1 15h52.1zm0-21.3v309.8h14.7V40.1z" id="path42"></path>
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-21" d="M383.8 72.5H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.4H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.3H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.3H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 6.4H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.3H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.3H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 6.4H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.4H414v2.4h-30.2zm0 5.6H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.3H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 6.3H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.7H414v2.4h-30.2zm0 5.6H414v2.4h-30.2z" id="path44"></path>
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-22" d="M371.3 71v126.4l36.4-112.7zm66.8 264.6h-66.8l52.1-43.1 14.7-104zM423.4 47.1l-44.2 7.5-7.9 7.5z" id="path46"></path>
    
    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-23" d="M101.8 202.9l-8.7 132.7h17.5zm39.9 22.8l-7.3 109.9h14.5z" id="path48"></path>
    
    <circle style="fill: rgb(255, 255, 255);" class="st1 svg-elem-24" cx="101.8" cy="253.4" r="13.5" id="circle50"></circle>

    <path style="fill: rgb(255, 255, 255);" class="st1 svg-elem-25" d="M173.9 180.6l-7.3 155h14.5z" id="path52"></path>

    <circle style="fill: rgb(255, 255, 255);" class="st1 svg-elem-26" cx="173.9" cy="257.1" r="11.9" id="circle54"></circle>

    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-27" d="M180.2 232.5c0 3.5-2.9 6.4-6.4 6.4s-6.4-2.9-6.4-6.4 2.9-6.4 6.4-6.4c3.6 0 6.4 2.9 6.4 6.4zM157.9 252h31.9v2.4h-31.9zm-72-4.4h31.9v2.4H85.9z" id="path56"></path>
    <path style="fill: rgb(255, 255, 255);"  class="st1 svg-elem-28" d="M164.3 229.8h19.1v2.4h-19.1zm52.5 105.8H295v-16.1l-10.1-10.6-29-3-27.3 13.3h-31.5l-7.3 16.4z" id="path58"></path>
    
    <path class="st7 svg-elem-29" d="M197.1 319.2l27.5 16.4 30.2-18.8 23.8 9.4 16.4-6.7m-42.4 16.1l26-9.4 16.4 9.4" id="path60"></path>

    <path class="st7 svg-elem-30" d="M284.9 308.9l-30.1 7.9-26.2 2.4-4 16.4m31.3-29.7l-1.1 10.9" id="path62"></path>
    
    <path style="fill: rgb(255, 255, 255);" class="st6 svg-elem-31" d="M609.6 294.7c-17.7 0-32 12.5-32.4 28.1H642c-.4-15.6-14.8-28.1-32.4-28.1zm-32.5 28.1c0 1.3 0 2.6.2 3.8.6 5.3 5.2 9.3 10.6 9.3h43.5c5.3 0 9.9-4 10.6-9.3.1-1.2.2-2.5.2-3.8h-65.1z" id="path64"></path>
    <path style="fill: rgb(255, 255, 255);"class="st6 svg-elem-32" d="M609.6 294.7c-9.7 0-17.7 12.5-17.9 28.1h35.8c-.2-15.6-8.2-28.1-17.9-28.1zm-17.9 28.1c0 1.3 0 2.6.1 3.8.4 5.3 2.9 9.3 5.8 9.3h24c3 0 5.5-4 5.8-9.3.1-1.2.1-2.5.1-3.8h-35.8z" id="path66"></path>
    <path style="fill: rgb(255, 255, 255);"class="st6 svg-elem-33" d="M605.3 329.6h6.3v6.3h-6.3z" id="path68"></path>
    
    <path class="st8 svg-elem-34" d="M577.1 322.8l-6.5 12.7m21.1-12.7l-6.6 12.7m56.9-12.7l6.6 12.7m-21.1-12.7l6.6 12.7" id="path70"></path>
    
    <path d="m 419.7,361.6 -4.5,0.2 2.7,-4 v -0.5 h 1.6 z" id="path935" style="fill: #fff; stroke: rgb(120, 144, 156); stroke-opacity: 1;" class="svg-elem-35"></path>
    
    
    <g id="g952">

      
    <path id="path74" style="fill: #fff; stroke: rgb(120, 144, 156); stroke-opacity: 1;" d="m 406,363.1 h 10.4 l 4.7,2 h 16.8 l 4.1,-1.8 h 5.2 c 0,4 -3.3,7.3 -7.3,7.3 h -21.3 c -2.7,0 -5.3,-1 -7.3,-2.8 z m 19.6,-4.7 h 3.3 v 3.3 h -3.3 z m 4.9,0 h 3.3 v 3.3 h -3.3 z m 10.5,-2.7 v 2.1 h -5.9 v 7.4 h -19.4 l -1.4,-2.1 0.9,-1.3 2.7,-4 v -2.1 z" class="svg-elem-36">

    </path>

  
  </g>
    
    <g id="g946">
    
    <path d="m 201.6,361.2 h 3.3 v 3.3 h -3.3 z" id="path927" style="stroke: rgb(120, 144, 156); stroke-opacity: 1; fill: #fff;" class="svg-elem-37"></path>
    
    <path d="m 215.8,364.5 4.5,0.2 -2.8,-4.1 v -0.4 l -1.6,-0.1 z" id="path925" style="stroke: rgb(120, 144, 156); stroke-opacity: 1; fill: #fff;" class="svg-elem-38"></path>
    
    <path id="path76" style="fill: rgb(249, 249, 249); stroke-width: 1; stroke-miterlimit: 10; stroke: rgb(120, 144, 156); stroke-opacity: 1;" 
        d="m 229.5,366 h -10.4 l -4.7,2 h -16.8 l -4.1,-1.8 h -5.2 c 0,4 3.3,7.3 7.3,7.3 h 21.3 c 2.7,0 5.3,-1 7.3,-2.8 z m -23,-4.8 h 3.3 v 3.3 h -3.3 z m -12.1,-2.7 v 2.1 h 5.9 v 7.4 h 19.5 l 1.4,-2 -0.9,-1.3 -2.8,-4.1 v -2.1 z" class="svg-elem-39">
 
      </path>
        

      </g>
      
      
      
      <g id="g971"><path id="path78" style="stroke: rgb(120, 144, 156); stroke-opacity: 1; fill: #fff;" d="m 597.8,347.6 h -10.4 l -4.7,2 h -16.8 l -4.1,-1.8 h -5.2 c 0,4 3.3,7.3 7.3,7.3 h 21.3 c 2.7,0 5.3,-1 7.3,-2.8 z m -23,-4.7 h 3.3 v 3.3 h -3.3 z m 9.2,3.2 4.6,0.2 -2.8,-4 v -0.5 h -1.6 z m -14,-3.2 h 3.3 v 3.3 H 570 Z m -7.3,-2.7 v 2.1 h 5.9 v 7.4 h 19.5 l 1.4,-2.1 -0.9,-1.3 -2.8,-4 v -2.1 z" class="svg-elem-42"></path></g>
      
      <path style="fill: rgb(255, 255, 255);" class="st8 svg-elem-43" d="M701.4 321.2v14.4" id="path80"></path>
      
  
      <path
   style="opacity:0.6;stroke-dasharray:none;stroke-dashoffset:0"
   d="m 18,355.4 h 60.7 m 57,9.5 H 218 m -40.7,8.7 h 97.8 m -24.2,-8.7 h 63.2 m 3.4,-16.4 h 101.4 m -22.6,7.8 h 71.1 m -11.4,-7 h 90.9 m -441.4,2.6 h 98.6 m -148,13 h 49.4 m 347,0.9 h 123.8 m -57.1,-9.5 h 94.3 M 595.4,345 h 76.2 m -13.1,10.4 h 63.3 m 12,8.6 h -19.3 m -371.9,-0.8 h 43.5 M 237,351.1 h 38.3 m 51.7,24.2 h 36.4 m 43.3,-4.3 h 39.8 M 662,367.5 H 616.1 M 464.5,74.2 h 45.1 M 633,135.3 h 27 m -15.7,18.2 H 620 m 54.6,16.5 h -17.4 m -158,1.6 h 24.2 M 49.3,120.4 h 47.9 m 47.2,23.6 h 39.8 m -79.4,26 h 26.1"
   fill="none"
   stroke-linecap="round"
   stroke="#78909c"
   stroke-miterlimit="10"
   id="path26"
   class="svg-elem-12"
   sodipodi:nodetypes="cccccccccccccccccccccccccccccccccccccccccccccccccccccc" />
    

 <path style="fill: rgb(255, 255, 255);" class="st8 svg-elem-47" d="M357.8 321.2v14.4" id="path88"></path>


 <foreignObject x="0" y="0" width="300" height="52" style="text">
 
 <span id="smartLinkContainer">⤏ <a id="widget_link"></a></span>

</foreignObject>

 <path id="widget_rect" class="rect" transform="matrix(1,0,0,1,100,100)" d="M0,0c178,0,453.6,0,650,0c0,160.8,0,360.8,0,508c-189.7,0-459.1,0-650,0C0,346.9,0,141.6,0,0z"/>
     
    
     <text id="my_text" alignment-baseline="middle" x="512" y="71" fill="white"></text>
 
     <path class="bowedRect" d="M0,0c179.3-54.2,462-53.3,650,0c64.7,166.8,69,344,0,508c-186.5,56.9-460.7,55.5-650,0C-78,339-86.8,169.2,0,0z"/>
 
     <foreignObject x="676" y="44" width="52" height="52">
 
     <img id="widget_img" src="https://via.placeholder.com/800x800" alt=""/>
     
      </foreignObject>



    

    <foreignObject x="660" y="0" width="100" height="100">

    <div class="mynav">
    
    <div class="wrapper_menu">
  
      <div style="cursor: pointer;" class="ham">
        <span>☰</span>
      </div>
  
      <ul class="main-menu">
        <li id="boat1_target"><a>Ran1 => 3</a></li>
        <li id="boat2_target"><a>Ran2 => 6</a></li>
        <li id="boat3_target"><a>Reset</a></li>
      </ul>
  
      </div>
   </div>


   </foreignObject>
 
  
 </g>
</svg>

<div id="msg_text" class="subheading">Micro-interazioni (´◡`) Colora la città per attivare le... </div>    
<span style="margin-top:8px;" id="msg_text3">Elementi dipinti 0 su 30</span> 
</div><!--end svg div container-->


  
  </div><!-- column is-8 is-offset-2 -->
        

</div><!-- End columns is-vcentered -->

</div><!-- End City container -->






</div>


<div class='loader df aic jcc'>
  <div>
    <h1>Loading</h1>
    <h2 class='loader--text'>0%</h2>
  </div>
</div>
   

</div><!-- End Hero Body -> User can scroll -->
    
    <!-- SEcond Section -->
<div id="secondSection" class="section has-pseudo-lines gradient-circle no-line-top">

       


          <!-- CTA -->
      
          </div>

       <script>

const contentful = require('contentful')

const client = contentful.createClient({
  space: 'ot4vkuehzkq4',
  environment: 'master', // defaults to 'master' if not set
  accessToken: 'GHbPdILzxLkTyqE30Uv29jp5QmwiYaRc5WJjV3AOTHI'
})

client.getEntry('62BKfAhtlvWrxGpZvoJOV2')
  .then((entry) => console.log(entry))
  .catch(console.error)

	       
       </script>   
        
     


<div class='demo-wrapper con3'>
  <header class='df aic jcc'>
    <div>
      <h1>Applicazioni & Servizi Web</h1>
      <h2>Un team di sviluppo web che si prende cura dei tuoi obiettivi<br> Sviluppo siti web, applicazioni web, web services, implementazione api.<br> Soluzioni open source, servizi SaaS integrabili nel vostro progetto.</h2>
    </div>
  </header>
  <section class='demo-text'>
    <div class='wrapper text'>
      <span class="myblack">LDATA</span><span class="myblue">WEBDEV</span><span class="myblack">SOLUTIONS</span>
    </div>
  </section>
  <section class='demo-gallery'>
    <ul class='wrapper'>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=26' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=175' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=183' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=50' width='1240'>
      </li>
    </ul>
  </section>
  <section class='demo-gallery'>
    <ul class='wrapper'>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=133' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=113' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=38' width='1240'>
      </li>
    </ul>
  </section>
  <section class='demo-gallery'>
    <ul class='wrapper'>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=162' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=165' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=52' width='1240'>
      </li>
    </ul>
  </section>
  <section class='demo-gallery'>
    <ul class='wrapper'>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=50' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=87' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=124' width='1240'>
      </li>
      <li>
        <img height='874' src='https://source.unsplash.com/random/1240x874?sig=37' width='1240'>
      </li>
    </ul>
  </section>
  <section class='demo-text'>
    <div class='wrapper text'>
      <span class="myblue">OPEN</span><span class="myblack">SOURCE</span><span class="myblue">FANATIC</span>
    </div>
  </section>
  <footer class='df aic jcc'>
    <p>Esperienze utente intuitive e coinvolgenti <a href="https://webapps.livedata.it/servizi-web/content-strategy-con-foto-di-alta-qualita-a-costi-contenuti/">UI/UX Design</a></p>
  </footer>
</div>




<div id="trust" class="section">
        <div class="container">
            <!-- Title -->
            <div class="section-title-wrapper">
                <div class="bg-number"><i class="material-icons">apps</i></div>
                <h2 class="section-title-landing has-text-centered dark-text">
                    Costruiamo fiducia.
                </h2>
                <h4 class="has-text-centered">
                    <div class="head-action">


			    <p>Il nostro team collabora con  <a href="https://webstack.livedata.it/about/">clienti che guardano al futuro</a> con occhi innovativi.<br>
La loro visione all'avanguardia apre nuove possibilità, e noi le traduciamo in soluzioni digitali.</p>
			    
                  
                </div>
                </h4>

		
            </div>



            <!-- Grid -->
           
            




        </div>
    </div>

   

  <div class="con4 container2">
  
    
    <div class="customers-choice pt-0 pb-0">




    
                <div class="columns is-vcentered">


                 <!-- App showcase Section -->
  <div
      class="
        section
        is-medium
        section-feature-grey
        has-background-image
        is-contain
        has-pseudo-lines
      "
      data-background="img/graphics/legacy/circles-and-shapes.png"
    >




                    <div class="column is-5 is-offset-2 is-centered-tablet-portrait">
                        <h3 class="title is-5 dark-text pb-10">Qualche progetto in mente? Scrivici.</h3>
                        <p class="muted-text">
                        Ldata è speciale quanto le persone che la compongono: un team di designer, sviluppatori e creativi guidati dal desiderio di costruire esperienze utente non standard e significative.
                        </p>
                    </div>
                    
                    <div class="teammate column is-5 is-centered-tablet-portrait">
                        <img src="img/why-1.svg" alt="Esperienza utente e Core Web Vitals">
                    </div>
                </div>

            </div>
    
   


   
  </div> <!-- End container -->
    


    <!-- Footer -->
    <footer class="footer-light-medium">
        <div class="container">



            <div class="footer-head">
                <div class="head-text">
                    <h3>Da statico a dinamico</h3>
                    <p><a href="https://webstack.livedata.it/blog/percorso-siti-statici-processwire/" class="button primary-btn raised action-button is-bold">Un percorso graduale</a></p>
                </div>
                <div class="head-action">
                    <div class="buttons">
                        <a href="https://webstack.livedata.it/servizi/servizio-ui-ux/" class="button primary-btn raised action-button is-bold">Servizi front-end</a>
                        <a href="https://webstack.livedata.it/blog/programmazione-svg-tendenze/" class="button chat-button">SVG, acronimo di Scalable Vector Graphics</a>
                    </div>
                </div>
            </div>
            
            <div class="columns footer-body">
                <!-- Column -->
                <div class="column is-4">
                    <div class="pt-10 pb-10">
                     <a href="https://webstack.livedata.it"><img class="small-footer-logo" src="img/ldata-logo-icon.svg" alt="Livedata"></a>
                        <div class="footer-description">
                        Partire da una tela bianca, prendere in mano un mouse e creare qualcosa su misura è molto gratificante. Sviluppare un'idea concettuale in qualcosa di coinvolgente e funzionale può essere altrettanto soddisfacente.
                        </div>
                    </div>
                    
                    <div>
                        <span class="moto">Designed and coded with <i class="fa fa-heart color-red"></i> by LDATA.</span>
                        <div class="social-links">
                            <a href="#">
                                <span class="icon"><i class="fa fa-facebook"></i></span>
                            </a>
                            <a href="#">
                                <span class="icon"><i class="fa fa-twitter"></i></span>
                            </a>
                            <a href="#">
                                <span class="icon"><i class="fa fa-linkedin"></i></span>
                            </a>
                            <a href="#">
                                <span class="icon"><i class="fa fa-dribbble"></i></span>
                            </a>
                            <a href="#">
                                <span class="icon"><i class="fa fa-github"></i></span>
                            </a>
                        </div>
                    </div>
                </div>
               
                <!-- Column -->
                <div class="column is-6 is-offset-2">
                    <div class="columns">
                        <!-- Column -->
                        <div class="column">
                            <ul class="footer-column">
                                <li class="column-header">
                                    Demo Link
                                </li>
                                <li class="column-item"><a href="#">Home</a></li>
                                <li class="column-item"><a href="#">Pricing</a></li>
                                <li class="column-item"><a href="#">Get started</a></li>
                                <li class="column-item"><a href="#">Help</a></li>
                            </ul>
                        </div>
                        <!-- Column -->
                        <div class="column">
                            <ul class="footer-column">
                                <li class="column-header">
                                    Demo Link
                                </li>
                                <li class="column-item"><a href="#">Learning</a></li>
                                <li class="column-item"><a href="#">Support center</a></li>
                                <li class="column-item"><a href="#">Frequent questions</a></li>
                                <li class="column-item"><a href="#">Schedule a demo</a></li>
                            </ul>
                        </div>
                        <!-- Column -->
                        <div class="column">
                            <ul class="footer-column">
                                <li class="column-header">
                                     Demo Link
                                </li>
                                <li class="column-item"><a href="#">Terms of Service</a></li>
                                <li class="column-item"><a href="#">Privacy policy</a></li>
                                <li class="column-item"><a href="#">SaaS services</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-copyright has-text-centered">
                <p>&copy; 1999 | 2024<a href="https://livedata.it>"> LDATA</a> | All Rights Reserved.</p>
            </div>
        </div>
    </footer>
  
    <div id="backtotop"><a href="#"></a></div>   

    
</div><!-- End Circle and shapes -->

</div> <!-- End Second Section -->

</div><!--end SCENE 1-->

<style>

#errorLi {
margin: 165px auto 15px auto !important;
}

</style>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">


<script src="js/app.js"></script>
<script src="js/core.js"></script>

</body>

</html>
